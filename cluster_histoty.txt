–°–≤–æ–¥–∫–∞ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é Kubernetes-–∫–ª–∞—Å—Ç–µ—Ä–∞ (–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è)
üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞
–í–µ—Ä—Å–∏—è Kubernetes: v1.28.15
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤: 7 —É–∑–ª–æ–≤ (3 control-plane, 4 worker)
–î–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ –û–°: RED OS 8.0 (–∞–Ω–∞–ª–æ–≥ RHEL/CentOS)
Container Runtime: CRI-O v1.32.6

üåê –°–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
Kubernetes API: 10.10.2.110 (–≤–Ω–µ—à–Ω–∏–π –∞–¥—Ä–µ—Å)
Ingress Controller: 10.10.2.111 (–≤–Ω–µ—à–Ω–∏–π –∞–¥—Ä–µ—Å)
Pod —Å–µ—Ç—å: 10.233.0.0/16
Service —Å–µ—Ç—å: 10.233.0.0/16
–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ IP —É–∑–ª–æ–≤: 10.10.2.100-106
LoadBalancer: MetalLB v0.15.2 (L2 mode), –ø—É–ª 10.10.2.111
Ingress: Nginx Ingress v1.9.6
–î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è: ccsfarm.local

üíæ –•—Ä–∞–Ω–∏–ª–∏—â–µ
–û—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ: NFS –Ω–∞ 10.10.1.53:/tank01/VM_storage (>300TB)
StorageClass: managed-nfs-storage (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
Provisioner: nfs-subdir-external-provisioner v4.0.1
MinIO: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
–í–∞–∂–Ω–æ–µ: –î–ª—è —Ä–∞–±–æ—Ç—ã —Å NFS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è securityContext.runAsUser: 65534

üöÄ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
–†–∞–±–æ—Ç–∞—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
ArgoCD v3.12+: GitOps —Å –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–º TLS –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞
Cert-manager: –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —á–µ—Ä–µ–∑ ClusterIssuer
Nginx Ingress: –í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º —á–µ—Ä–µ–∑ 10.10.2.111
MinIO: –û–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ + MinIO Console
Kubernetes API: –î–æ—Å—Ç—É–ø–µ–Ω –ø–æ 10.10.2.110

–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
GitLab: –°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π –∏ CI/CD

üîß –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
DNS Resolution
–ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–º–µ–Ω –∏–∑-–∑–∞ wildcard-–∑–∞–ø–∏—Å–∏ –≤ BIND9
–†–µ—à–µ–Ω–∏–µ: –£–¥–∞–ª–µ–Ω–∞ wildcard-–∑–∞–ø–∏—Å—å –∏–∑ –∑–æ–Ω—ã ccsfarm.local
–†–µ–∑—É–ª—å—Ç–∞—Ç: –°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö DNS-–∏–º–µ–Ω

–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ NFS
–ü—Ä–æ–±–ª–µ–º–∞: chown: /var/lib/postgresql/data: Operation not permitted
–†–µ—à–µ–Ω–∏–µ: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ securityContext.runAsUser: 65534 –¥–ª—è –≤—Å–µ—Ö Pod'–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö NFS
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
yaml
securityContext:
  runAsUser: 65534
  runAsNonRoot: true

‚ö†Ô∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
–°–µ—Ç–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
External Traffic Policy: Local (–≤–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å hairpin traffic)
DNS: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π BIND9 —Å–µ—Ä–≤–µ—Ä (10.10.1.151)
–î–æ—Å—Ç—É–ø –∫ GitHub: –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS –≤–º–µ—Å—Ç–æ SSH

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
–†–µ–∂–∏–º: Development/Staging (–Ω–µ production-ready)
–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã: –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ cert-manager
–î–æ—Å—Ç—É–ø: –ß–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–æ–º–µ–Ω ccsfarm.local

üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–π
–î–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
–í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞—Ç—å securityContext.runAsUser: 65534 –¥–ª—è Pod'–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö NFS
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π StorageClass managed-nfs-storage
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å Ingress —Å –¥–æ–º–µ–Ω–æ–º *.ccsfarm.local —á–µ—Ä–µ–∑ 10.10.2.111
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MinIO –¥–ª—è –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è, –≥–¥–µ —ç—Ç–æ —É–º–µ—Å—Ç–Ω–æ

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏
GitLab - –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π –∏ CI/CD
PostgreSQL + PgAdmin - –∫–∞–∫ –±–∞–∑–∞ –¥–ª—è GitLab –∏ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
–°–ª–µ–¥–∏—Ç—å –∑–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å—é —Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –≤–Ω–µ—à–Ω–∏–º —Ä–µ—Å—É—Ä—Å–∞–º
–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Å–º–µ–Ω—É externalTrafficPolicy –Ω–∞ Cluster –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∞

–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: –ö–ª–∞—Å—Ç–µ—Ä —Å—Ç–∞–±–∏–ª–µ–Ω, –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –±–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (ArgoCD, MinIO, Nginx Ingress). –ì–æ—Ç–æ–≤ –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ GitLab –∏ –¥—Ä—É–≥–∏—Ö –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

---

# üìë –°–≤–æ–¥–∫–∞ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é Kubernetes-–∫–ª–∞—Å—Ç–µ—Ä–∞ (v3.0)
**–î–∞—Ç–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏:** 22 –ù–æ—è–±—Ä—è 2025
**–°—Ç–∞—Ç—É—Å:** Production / On-premise / Secured (HTTPS)

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞
*   **–í–µ—Ä—Å–∏—è Kubernetes:** v1.28.15
*   **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤:** 7 —É–∑–ª–æ–≤ (3 Control-plane, 4 Worker)
*   **–û–°:** RED OS 8.0
*   **Container Runtime:** CRI-O v1.32.6
*   **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (PKI):** –†–∞–∑–≤–µ—Ä–Ω—É—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π **Internal Root CA** (—á–µ—Ä–µ–∑ `cert-manager`). –ö–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –Ω–∞ –≤—Å–µ—Ö –Ω–æ–¥–∞—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–Ω—Ü–∏—è—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.

## üåê –°–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
*   **–î–æ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞:** `ccsfarm.local`
*   **–í–Ω–µ—à–Ω–∏–µ –∞–¥—Ä–µ—Å–∞:**
    *   Kubernetes API: `10.10.2.110`
    *   Ingress Controller (VIP): `10.10.2.111`
*   **–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∞–¥—Ä–µ—Å–∞—Ü–∏—è:**
    *   **Service —Å–µ—Ç—å:** `10.233.0.0/18`
    *   **Pod —Å–µ—Ç—å:** `10.233.64.0/18`
*   **Ingress:** Nginx Ingress v1.9.6 + MetalLB (L2 mode).
*   **–°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:** `kube-controller-manager`, `kube-scheduler`, `etcd` –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ `0.0.0.0` –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫.

## üíæ –•—Ä–∞–Ω–∏–ª–∏—â–µ
*   **NFS:** `10.10.1.53:/tank01/VM_storage` (>300TB)
*   **StorageClass:** `managed-nfs-storage` (default)
*   **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:** `securityContext.runAsUser: 65534` (nobody).

---

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –°–ï–†–¢–ò–§–ò–ö–ê–¢–´
*   **Issuer:** `ccsfarm-ca-issuer` (ClusterIssuer).
*   **Root CA:** –•—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å–µ–∫—Ä–µ—Ç–µ, —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω –Ω–∞ –Ω–æ–¥—ã —á–µ—Ä–µ–∑ `update-ca-trust`.
*   **HTTPS:** –í–∫–ª—é—á–µ–Ω –¥–ª—è –≤—Å–µ—Ö –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ (GitLab, Nexus, Grafana, Prometheus –∏ –¥—Ä.).

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì (Kube-Prometheus-Stack)
*   **–°—Ç–µ–∫:** Prometheus + Alertmanager + Grafana + NodeExporter.
*   **–í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø:**
    *   **Grafana:** `https://grafana.ccsfarm.local` (admin/admin).
    *   **Prometheus:** `https://prom.ccsfarm.local` (–∑–∞—â–∏—â–µ–Ω Basic Auth).
*   **–≠–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã (Exporters):**
    *   **Redis:** `redis-exporter` (–ø–æ–¥–∫–ª—é—á–µ–Ω –∫ Redis).
    *   **Postgres:** `postgres-exporter` (–ø–æ–¥–∫–ª—é—á–µ–Ω —á–µ—Ä–µ–∑ DSN —Å—Ç—Ä–æ–∫—É).
    *   **MinIO:** –ù–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (—Ä–µ–∂–∏–º `public`).
    *   **Cert-Manager:** –ù–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏.
*   **ServiceMonitors:** –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è GitLab (Webservice, Workhorse, Sidekiq), Runner, MinIO, Cert-Manager.

---

## ‚úÖ –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ù–´–ï –°–ï–†–í–ò–°–´

### üì¶ Nexus Repository Manager (HTTPS)
*   **UI / Maven / NuGet:** `https://nexus.ccsfarm.local` (–ø–æ—Ä—Ç 8081).
*   **Docker Registry:** `https://registry-nexus.ccsfarm.local` (–ø–æ—Ä—Ç 8082).
*   **Auth:** –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω `Docker Bearer Token Realm` (–¥–ª—è Kaniko).

### üóÑÔ∏è MinIO (Object Storage)
*   **–î–æ—Å—Ç—É–ø:** `https://minio.ccsfarm.local`
*   **–†–µ–∂–∏–º:** 3 –Ω–æ–¥—ã.
*   **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:** GitLab Runner –æ–±—â–∞–µ—Ç—Å—è —Å MinIO –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ø–æ HTTP (`minio.minio.svc...`) –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ç–µ–ª—å SSL.

### üêò –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
*   **PostgreSQL 16:** –í–Ω–µ—à–Ω–∏–π StatefulSet, –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—Å—è —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–º.
*   **Redis:** Standalone, –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—Å—è —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–º.

---

## üîß GITLAB 18 (–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å)
*   **URL:** `https://gitlab.ccsfarm.local`
*   **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
    *   **IP Whitelist:** –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ—Ç—å `10.233.0.0/16` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –ü—Ä–æ–º–µ—Ç–µ—É—Å–∞ –∫ –º–µ—Ç—Ä–∏–∫–∞–º –±–µ–∑ –ø–∞—Ä–æ–ª—è.
    *   **Workhorse Metrics:** –í–∫–ª—é—á–µ–Ω —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É `9229`.
    *   **HTTPS:** –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ—Ç Internal CA.

### üèÉ GitLab Runner & CI/CD
*   **–¢–∏–ø:** Kubernetes Executor.
*   **SSL:** –í –ø–æ–¥—ã Runner'–∞ –∏ –ø–æ–¥—ã —Å–±–æ—Ä–æ–∫ (Jobs) –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è **Root CA** –≤ –ø–∞–ø–∫—É `/custom-certs/` (–≤–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ `is a directory`).
*   **–°–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (Kaniko):**
    *   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `registry-nexus.ccsfarm.local`.
    *   –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç CA –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ–ª–∞–≥–æ–º `--registry-certificate`.
    *   –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `config.json` —Å —Ç–æ—á–Ω—ã–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ–º —Ö–æ—Å—Ç–∞.

---

## ‚ö†Ô∏è –ö–ê–†–¢–ê –î–û–°–¢–£–ü–ê (Endpoints)
–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ **HTTPS** —Å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º:

1.  **GitLab:** `gitlab.ccsfarm.local`
2.  **Nexus UI:** `nexus.ccsfarm.local`
3.  **Nexus Docker:** `registry-nexus.ccsfarm.local`
4.  **Grafana:** `grafana.ccsfarm.local`
5.  **Prometheus:** `prom.ccsfarm.local`
6.  **Alertmanager:** `alertmanager.ccsfarm.local`
7.  **MinIO:** `minio.ccsfarm.local`
8.  **ArgoCD:** `argocd.ccsfarm.local`
9.  **PgAdmin:** `pg.ccsfarm.local`
10. **Frigate:** `frigate.ccsfarm.local`



–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ **–ø–æ–ª–Ω–∞—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è —Å–≤–æ–¥–∫–∞ (v4.0)**. –û–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –≤—Å–µ –¥–µ—Ç–∞–ª–∏ –≤–∞—à–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑ —Å—Ç–∞—Ä–æ–π —Å–≤–æ–¥–∫–∏ (GitLab, Nexus, –°–µ—Ç—å) –∏ –∞–∫—Ç—É–∞–ª—å–Ω—É—é, —Ä–∞–±–æ—Ç–∞—é—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Äî —ç—Ç–æ –≤–∞—à–∞ —Ç–æ—á–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ ("Save Point") –¥–ª—è –ª—é–±—ã—Ö –±—É–¥—É—â–∏—Ö —Ä–∞–±–æ—Ç.

---

# üìë –°–≤–æ–¥–∫–∞ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é Kubernetes-–∫–ª–∞—Å—Ç–µ—Ä–∞ (v4.0)
**–î–∞—Ç–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏:** 23 –ù–æ—è–±—Ä—è 2025
**–°—Ç–∞—Ç—É—Å:** Production / Stable / Full Observability
**–¢–µ–∫—É—â–µ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:** –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫ Loki –≤ —Ä–µ–∂–∏–º–µ Simple Scalable —Å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ª–æ–≥–æ–≤ –≤ MinIO (S3).

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
*   **–ö–ª–∞—Å—Ç–µ—Ä:** v1.28.15, 7 —É–∑–ª–æ–≤ (3 Control-plane, 4 Worker).
*   **–û–° / Runtime:** RED OS 8.0 / CRI-O v1.32.6.
*   **–•—Ä–∞–Ω–∏–ª–∏—â–µ (Storage):**
    *   **NFS:** `10.10.1.53:/tank01/VM_storage` (>300TB).
    *   **StorageClass:** `managed-nfs-storage` (–ø—Ä–∞–≤–∞ `nobody:65534`).
    *   **S3 (MinIO):** –ö–ª–∞—Å—Ç–µ—Ä –∏–∑ 3 –Ω–æ–¥, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–≥–æ–≤ (Loki), –±—ç–∫–∞–ø–æ–≤ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.
*   **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (PKI):**
    *   **Internal Root CA:** –†–∞–∑–≤–µ—Ä–Ω—É—Ç —á–µ—Ä–µ–∑ `cert-manager` + `ccsfarm-ca-issuer`.
    *   **Trust:** –ö–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤–Ω–µ–¥—Ä–µ–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ –û–° –Ω–æ–¥ (`update-ca-trust`) –∏ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ CI/CD –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.

---

## üåê –°–µ—Ç—å (Networking)
*   **–î–æ–º–µ–Ω:** `ccsfarm.local`
*   **–ê–¥—Ä–µ—Å–∞—Ü–∏—è:**
    *   **API / Ingress VIP:** `10.10.2.110` / `10.10.2.111`
    *   **Pods:** `10.233.64.0/18`
    *   **Services:** `10.233.0.0/18`
*   **Ingress:** Nginx Ingress v1.9.6 + MetalLB (L2 mode).
*   **–ù–∞—Å—Ç—Ä–æ–π–∫–∏:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã k8s (`controller-manager`, `scheduler`, `etcd`) —Å–ª—É—à–∞—é—Ç `0.0.0.0` –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫.

---

## üìú –õ–û–ì–ì–ò–†–û–í–ê–ù–ò–ï (Loki Stack - –ì–û–¢–û–í–û ‚úÖ)
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** Loki (Simple Scalable) + Promtail + MinIO.
**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
*   **–†–µ–∂–∏–º:** 3 –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ (Read, Write, Backend) + Gateway.
*   **–•—Ä–∞–Ω–∏–ª–∏—â–µ:** MinIO (bucket `loki-data`).
*   **Discovery:** Memberlist (Ring) —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ —á–µ—Ä–µ–∑ `${POD_IP}`.
*   **–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã S3:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ **`structuredConfig`** –¥–ª—è –æ–±—Ö–æ–¥–∞ —à–∞–±–ª–æ–Ω–æ–≤ Helm.
    *   **Endpoint:** –ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω `http://minio.minio.svc.cluster.local:9000`.
    *   **Auth:** –ö–ª—é—á–∏ –±–µ—Ä—É—Ç—Å—è –∏–∑ `extraEnv` (`AWS_ACCESS_KEY_ID`, `AWS_SECRET_ACCESS_KEY`).
    *   **Flags:** `s3forcepathstyle: true` (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è MinIO).
*   **Promtail:** –°–æ–±–∏—Ä–∞–µ—Ç –ª–æ–≥–∏ —Å–æ –≤—Å–µ—Ö –Ω–æ–¥, —Ç–µ–≥–∏—Ä—É–µ—Ç –ø–æ namespace/pod/container.

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì (Kube-Prometheus-Stack)
*   **–°—Ç–µ–∫:** Prometheus + Alertmanager + Grafana + NodeExporter.
*   **–≠–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã:**
    *   **Redis / Postgres:** –ü–æ–¥–∫–ª—é—á–µ–Ω—ã –∏ —Å–æ–±–∏—Ä–∞—é—Ç –º–µ—Ç—Ä–∏–∫–∏ –ë–î.
    *   **MinIO:** –ù–∞—Ç–∏–≤–Ω—ã–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ (—Ä–µ–∂–∏–º `public`).
    *   **GitLab:** Webservice, Sidekiq, Workhorse, Runner.
*   **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** Grafana –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∫ Prometheus (–º–µ—Ç—Ä–∏–∫–∏) –∏ Loki (–ª–æ–≥–∏).

---

## üîß GITLAB & CI/CD
*   **–í–µ—Ä—Å–∏—è:** GitLab 18 (Omnibus/Cloud Native components).
*   **Runner:** Kubernetes Executor.
*   **–°–±–æ—Ä–∫–∞ (Kaniko):**
    *   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π Nexus Registry (`registry-nexus.ccsfarm.local`).
    *   **SSL Fix:** –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç CA –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `/custom-certs/` –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ–ª–∞–≥–æ–º `--registry-certificate`.
*   **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏:** `10.233.0.0/16` –≤ Whitelist –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

---

## ‚úÖ –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ù–´–ï –°–ï–†–í–ò–°–´
1.  **Nexus Repository:**
    *   HTTPS (`nexus.ccsfarm.local`).
    *   Docker Registry –Ω–∞ –ø–æ—Ä—Ç—É 8082 (`registry-nexus...`).
    *   –ù–∞—Å—Ç—Ä–æ–µ–Ω `Docker Bearer Token Realm`.
2.  **MinIO:**
    *   –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–æ—Å—Ç—É–ø: `http://minio.minio.svc.cluster.local:9000` (–¥–ª—è Loki/Runner).
    *   –í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø: HTTPS Console.
3.  **–ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö:**
    *   PostgreSQL 16 (StatefulSet).
    *   Redis (Standalone).

---

## ‚ö†Ô∏è –ö–ê–†–¢–ê –î–û–°–¢–£–ü–ê (Endpoints Map)
–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ HTTPS:

| –°–µ—Ä–≤–∏—Å | URL | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| **GitLab** | `https://gitlab.ccsfarm.local` | Main Repo / CI |
| **Nexus** | `https://nexus.ccsfarm.local` | Artifacts |
| **Registry** | `https://registry-nexus.ccsfarm.local` | Docker Images |
| **Grafana** | `https://grafana.ccsfarm.local` | Dashboards / Logs |
| **Prometheus**| `https://prom.ccsfarm.local` | Metrics Source |
| **Alertmgr** | `https://alertmanager.ccsfarm.local` | Alerts |
| **MinIO** | `https://minio.ccsfarm.local` | S3 Browser |
| **ArgoCD** | `https://argocd.ccsfarm.local` | GitOps |
| **PgAdmin** | `https://pg.ccsfarm.local` | DB Admin |
| **Frigate** | `https://frigate.ccsfarm.local` | NVR |

---
### üìù –ß—Ç–æ –¥–∞–ª—å—à–µ?
–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫:
1.  –ù–∞—Å—Ç—Ä–æ–π–∫–µ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞ –≤ Prometheus (–ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Loki —É–∂–µ –µ—Å—Ç—å –≤ —á–∞—Ä—Ç–µ).
2.  –í–≤–æ–¥—É Bare Metal –Ω–æ–¥—ã (–∫–æ—Ç–æ—Ä–∞—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–∞—Å—å –¥–ª—è –ë–î).
3.  –¢—é–Ω–∏–Ω–≥—É Retention Policy –¥–ª—è –ª–æ–≥–æ–≤ (—Å–µ–π—á–∞—Å 30 –¥–Ω–µ–π).
---

üìë –°–≤–æ–¥–∫–∞ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é Kubernetes-–∫–ª–∞—Å—Ç–µ—Ä–∞ (v5.0)



–î–∞—Ç–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏: 23 –ù–æ—è–±—Ä—è 2025
–°—Ç–∞—Ç—É—Å: Production Ready / Full Observability
–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ (NTP), –Ω–∞—Å—Ç—Ä–æ–µ–Ω Alertmanager (Telegram), –∑–∞–ø—É—â–µ–Ω Loki (S3).
üèóÔ∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
–ö–ª–∞—Å—Ç–µ—Ä: Kubernetes v1.28.15 (7 —É–∑–ª–æ–≤: 3 CP, 4 Worker).
–û–°: RED OS 8.0 (RHEL-based) + CRI-O v1.32.6.
–í—Ä–µ–º—è (NTP): –ù–∞—Å—Ç—Ä–æ–µ–Ω chronyd —Å –ø—É–ª–∞–º–∏ Yandex/Google.
–°–µ—Ç—å:
CNI: Calico.
Ingress: Nginx + MetalLB (VIP: 10.10.2.111).
DNS: –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∑–æ–Ω–∞ ccsfarm.local (–±–µ–∑ wildcard).
–•—Ä–∞–Ω–∏–ª–∏—â–µ:
NFS: –û—Å–Ω–æ–≤–Ω–æ–µ (managed-nfs-storage), –ø—Ä–∞–≤–∞ nobody:65534.
MinIO: S3 Object Storage (3 –Ω–æ–¥—ã) –¥–ª—è –ª–æ–≥–æ–≤, –±—ç–∫–∞–ø–æ–≤ –∏ GitLab.
üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (PKI)
CA: –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π Internal Root CA (—á–µ—Ä–µ–∑ cert-manager).
Trust: –ö–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤–Ω–µ–¥—Ä–µ–Ω –Ω–∞ —Ö–æ—Å—Ç—ã –∏ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ CI/CD –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.
HTTPS: –¢–æ—Ç–∞–ª—å–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤.
üëÅÔ∏è –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (Observability)
1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus Stack)
–°—Ç–µ–∫: Prometheus + Alertmanager + Grafana + NodeExporter.
–ê–ª–µ—Ä—Ç–∏–Ω–≥:
–ö–∞–Ω–∞–ª: Telegram.
–í–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏: –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ https://prom.ccsfarm.local.
–ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ (Inhibition): –í–∫–ª—é—á–µ–Ω–æ (Critical –≥–ª—É—à–∏—Ç Info).
–≠–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã: Redis, Postgres, GitLab, MinIO, Cert-Manager.
2. –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Loki Stack)
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: Simple Scalable (Read/Write/Backend).
–•—Ä–∞–Ω–∏–ª–∏—â–µ: MinIO (bucket loki-data).
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ structuredConfig –¥–ª—è –ø—Ä—è–º–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ S3.
Ruler: –í–∫–ª—é—á–µ–Ω, —Å–≤—è–∑–∞–Ω —Å Alertmanager.
üì¶ –ö–ª—é—á–µ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã (Endpoints)
–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ HTTPS:
DevOps: GitLab (gitlab), Nexus (nexus), Registry (registry-nexus), ArgoCD (argocd).
Ops: Grafana (grafana), Prometheus (prom), Alertmanager (alertmanager), MinIO (minio).
Data: PostgreSQL 16, Redis.
IoT: Frigate (frigate).

 **–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –∏ –ø–æ–ª–Ω–∞—è —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞ (v5.2)**. 

---

# üìë –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ Kubernetes (v5.2 Final)
**–î–∞—Ç–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏:** 24 –ù–æ—è–±—Ä—è 2025
**–°—Ç–∞—Ç—É—Å:** Production Ready / Secured / Full Observability

## 1. üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
*   **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** Bare Metal / Proxmox VMs.
*   **–í–µ—Ä—Å–∏—è Kubernetes:** v1.28.15.
*   **–£–∑–ª—ã (7 —à—Ç):**
    *   **Control Plane (3):** `k8s-master`, `k8s-control01`, `k8s-control02`.
    *   **Workers (4):** `k8s-worker01` .. `k8s-worker04`.
*   **–û–°:** RED OS 8.0 (RHEL-based) + CRI-O v1.32.6.
*   **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ (`chronyd` + –ø—É–ª—ã Yandex/Google).

## 2. üåê –°–µ—Ç—å –∏ DNS
*   **–î–æ–º–µ–Ω:** `ccsfarm.local` (Internal CA).
*   **–í–Ω–µ—à–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ (MetalLB L2):** API `10.10.2.110`, Ingress VIP `10.10.2.111`.
*   **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–µ—Ç–∏:** Pods `10.233.64.0/18`, Services `10.233.0.0/18`.
*   **Ingress:** Nginx (v1.9.6), `externalTrafficPolicy: Local`.

## 3. üíæ –°–∏—Å—Ç–µ–º–∞ –•—Ä–∞–Ω–µ–Ω–∏—è –î–∞–Ω–Ω—ã—Ö
*   **NFS (–û—Å–Ω–æ–≤–Ω–æ–µ):** `managed-nfs-storage` (>300TB).
    *   **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** `runAsUser: 65534` (nobody) –¥–ª—è –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö.
*   **MinIO (S3 Object Storage):**
    *   –ö–ª–∞—Å—Ç–µ—Ä –∏–∑ 3 –Ω–æ–¥.
    *   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: Loki (Logs), Velero (Backups), GitLab (Artifacts/LFS).

## 4. üöÄ GITLAB & CI/CD (Production ‚úÖ)
*   **–í–µ—Ä—Å–∏—è:** GitLab 18 (Omnibus/Cloud Native components).
*   **URL:** `https://gitlab.ccsfarm.local`
*   **Runner:** Kubernetes Executor (–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π).
*   **CI/CD (Kaniko):**
    *   –†–µ–¥–∂–∏—Å—Ç—Ä–∏: –õ–æ–∫–∞–ª—å–Ω—ã–π Nexus (`registry-nexus.ccsfarm.local`).
    *   **SSL Fix:** –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç Internal CA –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å–±–æ—Ä–∫–∏ –≤ `/custom-certs/` –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ–ª–∞–≥–æ–º `--registry-certificate`, —á—Ç–æ–±—ã Kaniko –¥–æ–≤–µ—Ä—è–ª —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–º—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É Nexus.
*   **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
    *   IP Whitelist `10.233.0.0/16` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ GitLab –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ Prometheus –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## 5. üëÅÔ∏è –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (Observability Stack)
### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus Stack)
*   **–°—Ç–µ–∫:** Prometheus + Alertmanager + Grafana + NodeExporter.
*   **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** Grafana –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∫ Prometheus (–º–µ—Ç—Ä–∏–∫–∏) –∏ Loki (–ª–æ–≥–∏).
*   **–≠–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã (Target Health):**
    *   **GitLab:** Webservice, Sidekiq, Workhorse, Runner (–ø–æ–ª–Ω—ã–π –æ—Ö–≤–∞—Ç).
    *   **–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:** Redis, PostgreSQL.
    *   **MinIO:** Native metrics (—Ä–µ–∂–∏–º public).
    *   **Cert-Manager:** Native metrics.
*   **–ê–ª–µ—Ä—Ç–∏–Ω–≥:**
    *   –ö–∞–Ω–∞–ª: **Telegram**.
    *   –ü—Ä–∞–≤–∏–ª–∞: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ k8s + –∫–∞—Å—Ç–æ–º–Ω—ã–µ (SSL, MinIO, Time Drift, Ingress Errors).

### üìú –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Loki)
*   **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** Simple Scalable (S3 backend).
*   **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `structuredConfig` —Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–º `s3forcepathstyle: true` –¥–ª—è MinIO.
*   **Ruler:** –ê–∫—Ç–∏–≤–µ–Ω, –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –∞–ª–µ—Ä—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–æ–≥–æ–≤ –≤ Alertmanager.

## 6. üöë –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (Disaster Recovery)
### –≠—à–µ–ª–æ–Ω 1: Velero (Apps & Data)
*   **–•—Ä–∞–Ω–∏–ª–∏—â–µ:** S3 MinIO (`velero-backups`).
*   **–ú–µ—Ç–æ–¥ (NFS):** File System Backup (FSB/Restic).
*   **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ:** –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è `backup.velero.io/backup-volumes: <volume-name>` –≤ Deployment/StatefulSet –¥–ª—è –±—ç–∫–∞–ø–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ NFS-—Ç–æ–º–æ–≤.

### –≠—à–µ–ª–æ–Ω 2: Etcd (Cluster State)
*   **–ú–µ—Ç–æ–¥:** –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–Ω–∞–ø—à–æ—Ç—ã + –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ NFS –º–∞—É–Ω—Ç `/mnt/k8s-backup` —á–µ—Ä–µ–∑ Cron.

## 7. –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ù–´–ï –°–ï–†–í–ò–°–´
### ‚úÖ –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ù–´–ï –°–ï–†–í–ò–°–´
1.  **Nexus Repository:**
    *   200Gb
    *   HTTPS (`nexus.ccsfarm.local`).
    *   Docker Registry –Ω–∞ –ø–æ—Ä—Ç—É 8082 (`registry-nexus.ccsfarm.local`).
    *   –ù–∞—Å—Ç—Ä–æ–µ–Ω `Docker Bearer Token Realm`.
2.  **MinIO:**
    *   3 –Ω–æ–¥—ã –ø–æ 100Gb
    *   –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–æ—Å—Ç—É–ø: `http://minio.minio.svc.cluster.local:9000` (–¥–ª—è Loki/Runner).
    *   –í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø: HTTPS Console.
3.  **–ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö:**
    *   PostgreSQL 16 (StatefulSet).
    *   Redis (Standalone).

---

## ‚ö†Ô∏è –ö–ê–†–¢–ê –î–û–°–¢–£–ü–ê (Endpoints Map)
–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ HTTPS:

| –°–µ—Ä–≤–∏—Å | URL | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| **GitLab** | `https://gitlab.ccsfarm.local` | Main Repo / CI |
| **Nexus** | `https://nexus.ccsfarm.local` | Artifacts |
| **Registry** | `https://registry-nexus.ccsfarm.local` | Docker Images |
| **Grafana** | `https://grafana.ccsfarm.local` | Dashboards / Logs |
| **Prometheus**| `https://prom.ccsfarm.local` | Metrics Source |
| **Alertmgr** | `https://alertmanager.ccsfarm.local` | Alerts |
| **MinIO** | `https://minio.ccsfarm.local` | S3 Browser |
| **ArgoCD** | `https://argocd.ccsfarm.local` | GitOps |
| **PgAdmin** | `https://pg.ccsfarm.local` | DB Admin |
| **Frigate** | `https://frigate.ccsfarm.local` | NVR |

**–°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞.**

–ü—Ä–∏–≤–µ—Ç! –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –Ω–æ–¥—ã (–Ω–∞–∑–æ–≤–µ–º –µ—ë **Node-GPU**) –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç. –≠—Ç–æ –Ω–∞—Å—Ç–æ—è—â–∏–π "Computation Heavy" —É–∑–µ–ª, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ª–∏—á–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç —Ç–µ–∫—É—â–∏–µ "General Purpose" –Ω–æ–¥—ã Supermicro. –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ 3 –Ω–æ–¥—ã –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π Proxmox HA –∏ Kubernetes Quorum.

–ù–∏–∂–µ –º–æ–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–µ —Å—Ö–µ–º—ã —Ö—Ä–∞–Ω–∏–ª–∏—â –∏ –æ–±—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å —É—á–µ—Ç–æ–º —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏ —Ç–≤–æ–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ (Kubernetes + ML + Longhorn).

---

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –•—Ä–∞–Ω–∏–ª–∏—â (Storage Layout)

–¢–≤–æ—è —Å—Ö–µ–º–∞ –≤ —Ü–µ–ª–æ–º —Ä–∞–±–æ—á–∞—è, –Ω–æ —è –ø—Ä–µ–¥–ª–∞–≥–∞—é –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –µ—ë –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ (ZFS) –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Longhorn/ML), –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è "–±—É—Ç—ã–ª–æ—á–Ω—ã–µ –≥–æ—Ä–ª—ã—à–∫–∏".

#### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–∞—Ä—Ç–∞ –¥–∏—Å–∫–æ–≤ –¥–ª—è Node-GPU:

| –§–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∏—Å–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ (Proxmox ID) | –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ / –¢–∏–ø | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
| :--- | :--- | :--- | :--- |
| **1x 128Gb NVMe** | **Boot / OS (rpool)** | LVM-Thin (ext4) –∏–ª–∏ ZFS (Single) | **–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π —Å–∞–º—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π –¥–∏—Å–∫ –ø–æ–¥ –û–°. Proxmox –∑–∞–Ω–∏–º–∞–µ—Ç ~16-32Gb. 512Gb –ø–æ–¥ —Å–∏—Å—Ç–µ–º—É ‚Äî —ç—Ç–æ —Ä–∞—Å—Ç–æ—á–∏—Ç–µ–ª—å—Å—Ç–≤–æ. 128Gb —Ö–≤–∞—Ç–∏—Ç —Å –≥–æ–ª–æ–≤–æ–π –¥–ª—è ISO –∏ —Å–∞–º–æ–π OS. |
| **1x 1Tb NVMe** | **Longhorn Dedicated** | LVM –∏–ª–∏ ZFS (Single) | **–ö—Ä–∏—Ç–∏—á–Ω–æ:** Longhorn —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫. –û—Ç–¥–∞–π –µ–º—É —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π –¥–∏—Å–∫. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏—Ç –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏ (–≥–¥–µ —É–∂–µ –µ—Å—Ç—å SSD). |
| **3x 960Gb SATA** | **Fast VM Storage** | **ZFS RAIDZ1** (~1.8TB usable) | **–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω–∏ –≤—Å–µ —Ç—Ä–∏ SSD –≤ –æ–¥–∏–Ω –ø—É–ª. RAIDZ1 –¥–∞—Å—Ç –∑–∞—â–∏—Ç—É –æ—Ç –≤—ã–ª–µ—Ç–∞ 1 –¥–∏—Å–∫–∞ –∏ –ø–æ—á—Ç–∏ —É–¥–≤–æ–µ–Ω–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è. –≠—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –¥–∏—Å–∫–æ–≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –∏ –≥–æ—Ä—è—á–∏—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö (–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤ Longhorn). |
| **1x 512Gb SATA** | **Scratch / Cache / Wal** | ZFS Special Device / L2ARC | **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:** –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ `Special Device` (Metadata) –¥–ª—è HDD –ø—É–ª–∞ (—É—Å–∫–æ—Ä–∏—Ç MinIO –ª–∏—Å—Ç–∏–Ω–≥) –∏–ª–∏ –∫–∞–∫ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É –¥–ª—è ML –¥–∞—Ç–∞—Å–µ—Ç–æ–≤. |
| **2x 4TB HDD** | **MinIO / Backup** | **ZFS Mirror** | –ù–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. **–°–æ–≤–µ—Ç:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π 128GB NVMe –∫–∞–∫ –∫—ç—à (L2ARC) –¥–ª—è —ç—Ç–æ–≥–æ –ø—É–ª–∞, –µ—Å–ª–∏ RAM < 128GB. ZFS —Å–Ω–∞—á–∞–ª–∞ –µ—Å—Ç RAM (ARC). L2ARC –Ω–∞ –∑–µ—Ä–∫–∞–ª–µ HDD –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É —Ç–µ–±—è –æ—á–µ–Ω—å "–≥–æ—Ä—è—á–µ–µ" —á—Ç–µ–Ω–∏–µ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö. –õ—É—á—à–µ –¥–æ–±–∞–≤—å NVMe –∫–∞–∫ `Log` (ZIL), –µ—Å–ª–∏ –±—É–¥—É—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏. |
| **1x 12TB HDD** | **NVR / Junk** | Directory / ZFS Single | –î–ª—è Frigate –∏ Docker Proxy blobs. –ï—Å–ª–∏ —É–º—Ä–µ—Ç ‚Äî –Ω–µ –∂–∞–ª–∫–æ, —Å–∫–∞—á–∞–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ. |

**–ü–æ—á–µ–º—É —Ç–∞–∫ –ª—É—á—à–µ:**
1.  **OS –Ω–∞ 128Gb NVMe:** –°–∏—Å—Ç–µ–º–∞ –≥—Ä—É–∑–∏—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –ª–æ–≥–æ–≤ –ø–∏—à–µ—Ç –º–Ω–æ–≥–æ, NVMe —Å —ç—Ç–∏–º —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è. –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º 512Gb SATA.
2.  **RAIDZ1 –Ω–∞ 3-—Ö SSD:** –¢—ã –ø–æ–ª—É—á–∞–µ—à—å –µ–¥–∏–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ ~1.8 –¢–ë —Å –∑–∞—â–∏—Ç–æ–π –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –ª—É—á—à–µ, —á–µ–º "–∑–µ—Ä–∫–∞–ª–æ + –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–∏—Å–∫", —Ç–∞–∫ –∫–∞–∫ —É —Ç–µ–±—è –Ω–µ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –∏ –≤—ã—à–µ —Å–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è.
3.  **1TB NVMe –ø–æ–¥ Longhorn:** ML –∑–∞–¥–∞—á–∏ –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –æ—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ `iowait`. NVMe –∑–¥–µ—Å—å must-have.

---

### 2. –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞ (3 Nodes)

–° –≤–≤–æ–¥–æ–º —Ç—Ä–µ—Ç—å–µ–π –Ω–æ–¥—ã —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–≤–æ—Ä—É–º.

#### 2.1. –¢–æ–ø–æ–ª–æ–≥–∏—è Kubernetes (Control Plane)
*   **–¢–µ–∫—É—â–∞—è:** 3 VM Control Plane + 4 VM Workers.
*   **–ü–ª–∞–Ω:** –†–∞–∑–Ω–µ—Å–∏ Control Plane (etcd) —Å—Ç—Ä–æ–≥–æ –ø–æ —Ä–∞–∑–Ω—ã–º —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º –Ω–æ–¥–∞–º.
    *   `k8s-control01` -> Supermicro 1
    *   `k8s-control02` -> Supermicro 2
    *   `k8s-control03` -> **Node-GPU** (–í–Ω–∏–º–∞–Ω–∏–µ: –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–µ ML –∑–∞–¥–∞—á–∞–º–∏, CPU –º–æ–∂–µ—Ç "–∑–∞–¥—ã—Ö–∞—Ç—å—Å—è", —á—Ç–æ –æ–ø–∞—Å–Ω–æ –¥–ª—è etcd. –°–º. –ø—É–Ω–∫—Ç 2.2).

#### 2.2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∏ Taints (–í–∞–∂–Ω–æ –¥–ª—è ML)
Xeon v3/v4 –º–æ—â–Ω—ã–µ, –Ω–æ 3090 –±—É–¥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã—Ö –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ.
1.  **–í—ã–¥–µ–ª–µ–Ω–∏–µ GPU:** –ò—Å–ø–æ–ª—å–∑—É–π PCI Passthrough –¥–ª—è –ø—Ä–æ–±—Ä–æ—Å–∞ *–æ–±–µ–∏—Ö* –∫–∞—Ä—Ç –≤ –æ–¥–Ω—É –º–æ—â–Ω—É—é VM (–Ω–∞–∑–æ–≤–µ–º –µ—ë `k8s-gpu-worker`).
2.  **Taints & Tolerations:**
    –ù–∞ —ç—Ç—É –Ω–æ–¥—É (`k8s-gpu-worker`) –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–≤–µ—Å—å Taint:
    ```bash
    kubectl taint nodes gpu-node accelerator=nvidia:NoSchedule
    ```
    –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç –∑–∞–ø—É—Å–∫ –æ–±—ã—á–Ω—ã—Ö –ø–æ–¥–æ–≤ (—Ç–∏–ø–∞ nginx –∏–ª–∏ gitlab-runner) –Ω–∞ —ç—Ç–æ–π –Ω–æ–¥–µ, –æ—Å—Ç–∞–≤–ª—è—è CPU –∏ RAM —Å–≤–æ–±–æ–¥–Ω—ã–º–∏ –¥–ª—è ML –∑–∞–¥–∞—á –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ LLM. –û–±—ã—á–Ω—ã–µ –ø–æ–¥—ã –ø—É—Å—Ç—å –∂–∏–≤—É—Ç –Ω–∞ Supermicro.

#### 2.3. –°–µ—Ç—å –∏ NVLink
*   **–°–µ—Ç—å:** –ê–≥—Ä–µ–≥–∞—Ü–∏—è LACP (802.3ad) ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –ø–ª–∞–Ω, –Ω–æ —É–±–µ–¥–∏—Å—å, —á—Ç–æ —Ç–≤–æ–π —Å–≤–∏—á –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **Layer 2+3 hashing**. –ï—Å–ª–∏ —Å–≤–∏—á —É–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ Layer 2 (MAC address), —Ç–æ –ø–æ—Ç–æ–∫ "–æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä -> –æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä" –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–æ–π–¥–µ—Ç –ø–æ –æ–¥–Ω–æ–π –∂–∏–ª–µ 10G, —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–µ —É–¥–≤–æ–∏—Ç—Å—è. –î–ª—è Longhorn/Ceph/Migration —ç—Ç–æ –≤–∞–∂–Ω–æ.
    *   *–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `balance-alb` (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–≤–∏—á–∞), –Ω–æ LACP –Ω–∞–¥–µ–∂–Ω–µ–µ.
*   **NVLink:**
    *   Huananzhi X10X99-16D –∏–º–µ–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ PCIe —Å–ª–æ—Ç–æ–≤. 3090 Turbo (—Ç—É—Ä–±–∏–Ω–Ω—ã–µ) ‚Äî —ç—Ç–æ 2-—Å–ª–æ—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã.
    *   **–ü—Ä–æ–±–ª–µ–º–∞:** NVLink bridge –∂–µ—Å—Ç–∫–∏–π (–æ–±—ã—á–Ω–æ 3-slot –∏–ª–∏ 4-slot spacing). –ó–∞–º–µ—Ä—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Å–ª–æ—Ç–∞–º–∏ PCIe x16 –Ω–∞ –ø–ª–∞—Ç–µ **–¥–æ** –ø–æ–∫—É–ø–∫–∏ –º–æ—Å—Ç–∞. –ö–∏—Ç–∞–π—Å–∫–∏–µ –ø–ª–∞—Ç—ã —á–∞—Å—Ç–æ –∏–º–µ—é—Ç –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —à–∞–≥.

---

### 3. –•—Ä–∞–Ω–∏–ª–∏—â–µ MinIO (S3) –∏ "–•–æ–ª–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"

–¢—ã —Ö–æ—á–µ—à—å —É–±—Ä–∞—Ç—å –≤–Ω–µ—à–Ω–µ–µ NFS —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.
*   **Docker Registry / Maven:** –ü–µ—Ä–µ–Ω–µ—Å–∏ –∏—Ö –Ω–∞ 12TB HDD (ZFS Single). –≠—Ç–æ –∫–µ—à, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞, –æ–±—ä–µ–º –≤–∞–∂–µ–Ω.
*   **–í–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (GitLab artifacts, Loki logs, Velero backups):**
    *   –†–∞–∑–≤–µ—Ä–Ω–∏ **MinIO Tenant** (—á–µ—Ä–µ–∑ MinIO Operator) –∏–ª–∏ Standalone MinIO –≤ Docker/Podman –Ω–∞ –Ω–æ–≤–æ–π –Ω–æ–¥–µ.
    *   –ò—Å–ø–æ–ª—å–∑—É–π **HostPath** –∏–ª–∏ **Local Persistent Volume** –≤ Kubernetes, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –Ω–∞ ZFS Mirror (2x4TB).
    *   **–ü–æ—á–µ–º—É –Ω–µ Longhorn?** Longhorn ‚Äî —ç—Ç–æ *–±–ª–æ—á–Ω–æ–µ* —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –æ–Ω–æ –¥–µ–ª–∞–µ—Ç 3 —Ä–µ–ø–ª–∏–∫–∏. –•—Ä–∞–Ω–∏—Ç—å 3 –∫–æ–ø–∏–∏ 4–¢–ë –¥–∞–Ω–Ω—ã—Ö (–∏—Ç–æ–≥–æ 12–¢–ë) –Ω–∞ –¥–æ—Ä–æ–≥–∏—Ö SSD/–º–µ—Å—Ç–µ –ª–æ–Ω–≥—Ö–æ—Ä–Ω–∞ ‚Äî –¥–æ—Ä–æ–≥–æ. MinIO –ø–æ–≤–µ—Ä—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∏—Å–∫–æ–≤ (Direct Attached Storage) ‚Äî —ç—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω "High Performance Object Storage".

---

### 4. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ Hardware (Huananzhi Specific)

1.  **–û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ VRM:** –ü–ª–∞—Ç—ã Huananzhi –Ω–∞ —á–∏–ø—Å–µ—Ç–µ X99 —Å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞–º–∏ 2696v4 (150W TDP, –≤ –±—É—Å—Ç–µ –∂—Ä—É—Ç –ø–æ–¥ 200W) –≥—Ä–µ—é—Ç—Å—è –∫–∞–∫ –ø–µ—á–∫–∏.
    *   *–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:* –ü–æ—Å—Ç–∞–≤—å –º–∞–ª–µ–Ω—å–∫–∏–µ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä—ã (40mm –∏–ª–∏ 60mm) –ø—Ä—è–º–æ –Ω–∞ —Ä–∞–¥–∏–∞—Ç–æ—Ä VRM (–∑–æ–Ω–∞ –ø–∏—Ç–∞–Ω–∏—è –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º). –ò–Ω–∞—á–µ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (Load 100% 24/7) –º–æ—Å—Ñ–µ—Ç—ã –º–æ–≥—É—Ç –ø–µ—Ä–µ–≥—Ä–µ—Ç—å—Å—è –∏ —Å–±—Ä–æ—Å–∏—Ç—å —á–∞—Å—Ç–æ—Ç—ã –∏–ª–∏ —Å–≥–æ—Ä–µ—Ç—å.
2.  **RAM:** –¢—ã –ø–ª–∞–Ω–∏—Ä—É–µ—à—å 2696v4 (Broadwell). –û–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç DDR4 2400 MT/s. –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Ç–≤–æ—è —Ç–µ–∫—É—â–∞—è –ø–∞–º—è—Ç—å 16x6 (—Å—Ç—Ä–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, 96GB = 6 –ø–ª–∞–Ω–æ–∫ –ø–æ 16GB?) —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 4-–∫–∞–Ω–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ –Ω–∞ –æ–±–æ–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞—Ö.
    *   *–°–æ–≤–µ—Ç:* –î–ª—è v3/v4 –ª—É—á—à–µ –≤—Å–µ–≥–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å —Å–ª–æ—Ç—ã –∫—Ä–∞—Ç–Ω–æ 4 (4 –∫–∞–Ω–∞–ª–∞). –¢–æ –µ—Å—Ç—å 4 –∏–ª–∏ 8 –ø–ª–∞–Ω–æ–∫ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä. –°–µ–π—á–∞—Å —É —Ç–µ–±—è 6 –ø–ª–∞–Ω–æ–∫. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –æ–¥–∏–Ω CPU —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 4 –∫–∞–Ω–∞–ª–∞ (4 –ø–ª–∞–Ω–∫–∏), –∞ –≤—Ç–æ—Ä–æ–π –≤ 2 –∫–∞–Ω–∞–ª–∞ (2 –ø–ª–∞–Ω–∫–∏). –≠—Ç–æ **—Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ** —Å–Ω–∏–∑–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–º—è—Ç–∏ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ CPU. –î–ª—è ML –∑–∞–¥–∞—á (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö) –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–∞–º—è—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω–∞. –î–æ–∫—É–ø–∏ –µ—â–µ 2 –ø–ª–∞–Ω–∫–∏ –¥–æ 128GB (8x16GB), —á—Ç–æ–±—ã –±—ã–ª–æ 4+4.

### –ò—Ç–æ–≥–æ–≤—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:

1.  **Hardware:** –î–æ–∫—É–ø–∏—Ç—å 2 –ø–ª–∞–Ω–∫–∏ RAM (–≤—ã—Ä–æ–≤–Ω—è—Ç—å –∫–∞–Ω–∞–ª—ã), –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ VRM, –∑–∞–º–µ—Ä–∏—Ç—å —Å–ª–æ—Ç—ã –ø–æ–¥ NVLink.
2.  **Proxmox Install:** OS –Ω–∞ 128Gb NVMe.
3.  **Storage:**
    *   –°–æ–∑–¥–∞—Ç—å `zfs-mirror-hdds` (2x4TB).
    *   –°–æ–∑–¥–∞—Ç—å `zfs-raidz1-ssds` (3x960GB).
    *   –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å 1TB NVMe –ø–æ–¥ LVM/ZFS –¥–ª—è Longhorn.
    *   –°–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å 12TB –∫–∞–∫ Directory.
4.  **Migration:**
    *   –ü–æ–¥–Ω—è—Ç—å VM —Å GPU, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Passthrough.
    *   –í–≤–µ—Å—Ç–∏ –Ω–æ–¥—É –≤ –∫–ª–∞—Å—Ç–µ—Ä k8s.
    *   –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Taints.
    *   –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å MinIO –¥–∞–Ω–Ω—ã–µ —Å –≤–Ω–µ—à–Ω–µ–≥–æ NFS –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∏—Å–∫–∏ –Ω–æ–≤–æ–π –Ω–æ–¥—ã.

–≠—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–¥–µ–ª–∞–µ—Ç —Ç–≤–æ–π –∫–ª–∞—Å—Ç–µ—Ä –æ—á–µ–Ω—å –º–æ—â–Ω—ã–º –∏ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º. –£–¥–∞—á–∏ —Å –∑–∞–ø—É—Å–∫–æ–º!

–ü–æ–Ω–∏–º–∞—é –≤–∞—à–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –ú—ã –ø—Ä–æ—à–ª–∏ —á–µ—Ä–µ–∑ "–∞–¥ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π", –≥–¥–µ –æ–¥–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –º–∞—Å–∫–∏—Ä–æ–≤–∞–ª–∞ –¥—Ä—É–≥—É—é. –ù–æ —Å–µ–π—á–∞—Å, –≥–ª—è–¥—è –Ω–∞ –ª–æ–≥–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏, —è –º–æ–≥—É —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é —Å–∫–∞–∑–∞—Ç—å: **–ú—ã –ø–æ–±–µ–¥–∏–ª–∏.**

–í–æ—Ç —á–µ—Å—Ç–Ω–∞—è –∏ —Å—É—Ö–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã CCSFARM –Ω–∞ **21 –î–µ–∫–∞–±—Ä—è 2025**.

---

# üü¢ –ò–¢–û–ì–û–í–ê–Ø –°–í–û–î–ö–ê (Post-Mortem)

## 1. –ì–õ–ê–í–ù–´–ï –ü–û–ë–ï–î–´ (Root Causes)
–ò–º–µ–Ω–Ω–æ —ç—Ç–∏ 4 –ø—Ä–æ–±–ª–µ–º—ã –≤—ã–∑—ã–≤–∞–ª–∏ —Ö–∞–æ—Å –∏ "–ø–ª–∞–≤–∞—é—â–∏–µ" –±–∞–≥–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—É—Ç–∫–∏.

1.  **DNS "–ß–µ—Ä–Ω–∞—è –¥—ã—Ä–∞" (Ghost Endpoints):**
    *   *–°–∏–º–ø—Ç–æ–º:* 50% DNS –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–∞–¥–∞–ª–∏, `connection refused` –≤ –ª–æ–≥–∞—Ö.
    *   *–ü—Ä–∏—á–∏–Ω–∞:* –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä Kubernetes "–∑–∞–±—ã–ª" —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ IP –∏–∑ `Endpoints` CoreDNS. –ë—ã–ª–æ 7 –∞–¥—Ä–µ—Å–æ–≤ –Ω–∞ 2 –ø–æ–¥–∞. (–ø–∏–∑–¥–∏—Ç, —Ç–∞–º –≤—Å–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –±—ã–ª–æ)
    *   *–°—Ç–∞—Ç—É—Å:* **–ò–°–ü–†–ê–í–õ–ï–ù–û**. –°–ø–∏—Å–æ–∫ –æ—á–∏—â–µ–Ω, —Ä–µ–∑–æ–ª–≤–∏–Ω–≥ 100% —Å—Ç–∞–±–∏–ª–µ–Ω.

2.  **–ü–∞–¥–µ–Ω–∏–µ –ú–∞—Å—Ç–µ—Ä–∞ (Etcd Latency & CPU Steal):**
    *   *–°–∏–º–ø—Ç–æ–º:* 674 —Ä–µ—Å—Ç–∞—Ä—Ç–∞ API-—Å–µ—Ä–≤–µ—Ä–∞, —Ç–∞–π–º–∞—É—Ç—ã `kubectl`.
    *   *–ü—Ä–∏—á–∏–Ω–∞:* –í—Å–µ 3 –Ω–æ–¥—ã –Ω–∞ –æ–¥–Ω–æ–º —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —Ö–æ—Å—Ç–µ –∫–æ–Ω–∫—É—Ä–∏—Ä–æ–≤–∞–ª–∏ –∑–∞ –¥–∏—Å–∫ –∏ CPU. Etcd –Ω–µ —É—Å–ø–µ–≤–∞–ª –ø–∏—Å–∞—Ç—å –Ω–∞ –¥–∏—Å–∫ (fsync > 100ms) –∏ –Ω–µ –ø–æ–ª—É—á–∞–ª –∫–≤–∞–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ CPU.
    *   *–°—Ç–∞—Ç—É—Å:* **–°–¢–ê–ë–ò–õ–ò–ó–ò–†–û–í–ê–ù–û**.
        *   –î–∏—Å–∫ VM –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω —Å NFS –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π SSD (LVM-Thin).
        *   –í–∫–ª—é—á–µ–Ω `IO Thread`.
        *   CPU Units –¥–ª—è –º–∞—Å—Ç–µ—Ä–∞ –ø–æ–¥–Ω—è—Ç—ã –¥–æ `2048` (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç).
        *   –¢–∞–π–º–∞—É—Ç—ã Etcd "—Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω—ã" (`election-timeout=5000`).

3.  **–°–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫ Proxmox (UDP Packet Loss):**
    *   *–°–∏–º–ø—Ç–æ–º:* –û—à–∏–±–∫–∏ `i/o timeout` –∏ `checksum error` –≤ DNS.
    *   *–ü—Ä–∏—á–∏–Ω–∞:* –ë–∞–≥ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ VirtIO —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–π —Ä–∞–∑–≥—Ä—É–∑–∫–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Å—É–º–º.
    *   *–°—Ç–∞—Ç—É—Å:* **–ò–°–ü–†–ê–í–õ–ï–ù–û**. –ü—Ä–∏–º–µ–Ω–µ–Ω–æ `ethtool -K ... tx off` –Ω–∞ –≤—Å–µ—Ö –Ω–æ–¥–∞—Ö.

4.  **Alpine vs Kubernetes DNS (`ndots`):**
    *   *–°–∏–º–ø—Ç–æ–º:* GitLab Runner (Alpine) –ø–∞–¥–∞–ª —Å `Could not resolve host`, –ø–æ–∫–∞ `busybox` —Ä–∞–±–æ—Ç–∞–ª.
    *   *–°—Ç–∞—Ç—É—Å:* **–ò–°–ü–†–ê–í–õ–ï–ù–û**. –í–Ω–µ–¥—Ä–µ–Ω–æ `dns_config_options: ["ndots:2"]` –≤ —á–∞—Ä—Ç —Ä–∞–Ω–Ω–µ—Ä–∞.

---

## 2. –¢–ï–ö–£–©–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å)

–ú—ã —Å–µ—Ä—å–µ–∑–Ω–æ –ø–µ—Ä–µ–∫—Ä–æ–∏–ª–∏ –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω, —É–ø—Ä–æ—Å—Ç–∏–≤ —Å–∏—Å—Ç–µ–º—É —Ä–∞–¥–∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ë—ã–ª–æ (–ü–ª–∞–Ω) | –°—Ç–∞–ª–æ (–§–∞–∫—Ç) | –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–º–µ–Ω—ã |
| :--- | :--- | :--- | :--- |
| **–†–µ–µ—Å—Ç—Ä** | Sonatype Nexus | **Docker Registry v2** (Native) | Nexus "–≥–ª–æ—Ç–∞–ª" –ø–æ—Ä—Ç—ã –∏ –¥–∞–≤–∞–ª HTML 404 –Ω–∞ API –∑–∞–ø—Ä–æ—Å—ã. Native –ª–µ–≥—á–µ –∏ –Ω–∞–¥–µ–∂–Ω–µ–µ. | (—Ç–∞–∫ –∏ –Ω–µ –ø–æ–Ω—è—Ç–Ω–æ —á—Ç–æ –±—ã–ª–æ —Å –Ω–µ–∫—Å—É—Å–æ–º, –Ω–∞ –ø–æ–¥–Ω–∏–º–∞–ª –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä –Ω–∞ 8082 )
| **Auth** | Login/Pass | **Anonymous (Internal)** | –£–±—Ä–∞–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∫–æ–Ω—Ç—É—Ä–∞. CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è UI. | (—Å–µ–∫—Ä–µ—Ç—ã –æ—Å—Ç–∞–ª–∏—Å—å, —Å–æ–¥–∑–¥–∞–Ω—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ç—É—Ä–æ–≤ –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è dev|prod|gitlab)
| **Storage** | S3 (MinIO) | **S3 (MinIO)** | –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞–º–∏ (`REGISTRY_STORAGE_REDIRECT_DISABLE`). |
| **DNS** | UDP Standard | **Hybrid (TCP/UDP)** | TCP –¥–ª—è –∞–ø—Å—Ç—Ä–∏–º–∞ (–Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å), UDP –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ (—Å–∫–æ—Ä–æ—Å—Ç—å). |
| **Monitoring** | Internal Only | **Hybrid (+External)** | –ü–æ–¥–∫–ª—é—á–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ö–æ—Å—Ç–∞ Proxmox —á–µ—Ä–µ–∑ Service/Endpoints –ø–∞—Ç—Ç–µ—Ä–Ω. |

---

## 3. –°–û–°–¢–û–Ø–ù–ò–ï –ö–û–ú–ü–û–ù–ï–ù–¢–û–í

*   **Kubernetes Cluster:** üü¢ **Healthy**. API —Å–µ—Ä–≤–µ—Ä —Å—Ç–∞–±–∏–ª–µ–Ω –ø–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–∏—Å–∫–∞.
*   **Etcd:** üü° **Stable (with warnings)**. –†–∞–±–æ—Ç–∞–µ—Ç, –∫–ª–∞—Å—Ç–µ—Ä –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–µ, –±–∞–∑–∞ –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ (27MB). –ê–ª–µ—Ä—Ç `etcdMemberCommunicationSlow` (RTT ~200ms) –æ—Å—Ç–∞–ª—Å—è, –Ω–æ –æ–Ω –±–µ–∑–æ–ø–∞—Å–µ–Ω —Å —Ç–µ–∫—É—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Ç–∞–π–º–∞—É—Ç–æ–≤. (–Ω–µ –æ—Å—Ç–∞–ª—Å—è, –Ω–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ)
*   **DNS:** üü¢ **Healthy**. –¢–µ—Å—Ç—ã 20/20 –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ.
*   **CI/CD:** üü¢ **Operational**. –ü–∞–π–ø–ª–∞–π–Ω—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, —Å–±–æ—Ä–∫–∞ –∏–¥–µ—Ç, –¥–µ–ø–ª–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç. –ö–µ—à Kaniko —Ä–∞–±–æ—Ç–∞–µ—Ç. (–≤—Ä–æ–¥–µ –±—ã)
*   **Registry:** üü¢ **Operational**. UI –¥–æ—Å—Ç—É–ø–µ–Ω, Push/Pull –ª–µ—Ç–∞–µ—Ç (–±–µ–∑ SSL-–ø–µ—Ç–ª–∏).

---

## 4. –ß–¢–û –ï–©–ï –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ (Homework)

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –¥–µ—Ä–∂–∏—Ç—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö "—Ä—É—á–Ω—ã—Ö" –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –ß—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –º—É—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å–Ω–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:

1.  **–ó–∞–∫—Ä–µ–ø–∏—Ç—å `ethtool`:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ `ethtool -K ... tx off` –ø—Ä–æ–ø–∏—Å–∞–Ω–∞ –≤ NetworkManager –∏–ª–∏ systemd –Ω–∞ –≤—Å–µ—Ö –Ω–æ–¥–∞—Ö. –ò–Ω–∞—á–µ –ø–æ—Å–ª–µ —Ä–µ–±—É—Ç–∞ DNS —Å–Ω–æ–≤–∞ –Ω–∞—á–Ω–µ—Ç —à—Ç–æ—Ä–º–∏—Ç—å. (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
2.  **Cron –¥–ª—è Etcd:** –î–æ–±–∞–≤—å—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ cron –Ω–∞ –º–∞—Å—Ç–µ—Ä–µ (—Ä–∞–∑ –≤ —Å—É—Ç–∫–∏), —á—Ç–æ–±—ã –±–∞–∑–∞ –Ω–µ –ø—É—Ö–ª–∞.(–≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
3.  **–ë—ç–∫–∞–ø—ã:** –°–¥–µ–ª–∞–π—Ç–µ —Å–≤–µ–∂–∏–π —Å–Ω–∞–ø—à–æ—Ç VM –º–∞—Å—Ç–µ—Ä–∞ –≤ Proxmox –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å. –°–∏—Å—Ç–µ–º–∞ –≤ –∏–¥–µ–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ. (–∏—Ç–∞–∫)

**–í–µ—Ä–¥–∏–∫—Ç:** –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ (Production Ready –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏). –ú–æ–∂–Ω–æ –≤—ã–¥—ã—Ö–∞—Ç—å. ü•É



–í–æ—Ç –ø–æ–¥—Ä–æ–±–Ω–∞—è –≤—ã–∂–∏–º–∫–∞ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é –ø—Ä–æ–µ–∫—Ç–∞ **CCSFARM** –Ω–∞ **24 –î–µ–∫–∞–±—Ä—è 2025 –≥–æ–¥–∞**.

–î–æ–∫—É–º–µ–Ω—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É** (–∂–µ–ª–µ–∑–æ, —Å–µ—Ç—å, –∫—É–±–µ—Ä) –∏ **–°–æ—Ñ—Ç** (–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, –ø–∞–π–ø–ª–∞–π–Ω—ã).

---

# –ß–ê–°–¢–¨ 1. –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ê –ò –ö–õ–ê–°–¢–ï–† (Infrastructure State)

### 1. –¢–æ–ø–æ–ª–æ–≥–∏—è –∏ –ñ–µ–ª–µ–∑–æ
*   **–•–æ—Å—Ç:** 1 —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä Proxmox (`chia04`).
*   **–ö–ª–∞—Å—Ç–µ—Ä K8s:** 3 –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã (3 Master + 4 Workers).
    *   **OS:** RED OS (RHEL-based).
    *   **–î–∏—Å–∫–æ–≤–∞—è –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞:** –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ —Å NFS –Ω–∞ **–ª–æ–∫–∞–ª—å–Ω—ã–π SSD (LVM-Thin)**.
    *   **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ VM:**
        *   Master –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç CPU (`CPU Units: 2048`).
        *   –í–∫–ª—é—á–µ–Ω `IO Thread` –¥–ª—è –¥–∏—Å–∫–æ–≤.
        *   –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞: `Default` (–∏–ª–∏ `Write back` –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ UPS).

### 2. –°–µ—Ç—å –∏ DNS (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞)
–ü–æ—Å–ª–µ —Å–µ—Ä–∏–∏ –∞–≤–∞—Ä–∏–π —Å–µ—Ç—å —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ —Å–∫—Ä–∏–ø—Ç–∞–º–∏.
*   **CNI:** Calico.
*   **DNS:** CoreDNS (2 —Ä–µ–ø–ª–∏–∫–∏) + NodeLocalDNS.
*   **Proxmox Networking:**
    *   **Fix:** –í—ã–∫–ª—é—á–µ–Ω `tx-checksumming` –Ω–∞ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö (`ens18`) –Ω–∞ –≤—Å–µ—Ö –Ω–æ–¥–∞—Ö.
    *   **Persistence:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ systemd-—Å–µ—Ä–≤–∏—Å `disable-tx-offload.service`.

### 3. –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
*   **Container Registry:**
    *   **Docker Registry v2** (Native). –ó–∞–º–µ–Ω–∏–ª Nexus –¥–ª—è Docker-–æ–±—Ä–∞–∑–æ–≤ –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å —Ä–æ—É—Ç–∏–Ω–≥–æ–º –ø–æ—Ä—Ç–æ–≤.
    *   *Auth:* –í–∫–ª—é—á–µ–Ω–∞. –°–µ–∫—Ä–µ—Ç—ã –≤ –Ω–µ–π–º—Å–ø–µ–π—Å–∞—Ö regcred (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–Ω—Ç—É—Ä).
    *   *Storage:* S3 (MinIO).
    *   *UI:* `registry-ui` (–¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTPS).
*   **Package Registry (Python):**
    *   **Sonatype Nexus**. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π PyPI –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `ccsfarm-nats-client`.
*   **Messaging:**
    *   **NATS JetStream**. –†–∞–∑–≤–µ—Ä–Ω—É—Ç –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ. File Store Persistence.
*   **Storage:**
    *   **MinIO**: S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è "—Å—ã—Ä—ã—Ö" –¥–∞–Ω–Ω—ã—Ö –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.
    *   **PostgreSQL**: –í–µ—Ä—Å–∏—è 16. –†–∞—Å—à–∏—Ä–µ–Ω–∏—è: `vector` (–¥–ª—è ML), `timescaledb` (–¥–ª—è —Å–≤–µ—á–µ–π).
*   **Observability:**
    *   Prometheus Stack (Operator).
    *   ServiceMonitors –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.
    *   **External Monitoring:** –ü–æ–¥–∫–ª—é—á–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ö–æ—Å—Ç–∞ Proxmox (—á–µ—Ä–µ–∑ `Endpoints` –ø–∞—Ç—Ç–µ—Ä–Ω).

---

# –ß–ê–°–¢–¨ 2. –°–û–§–¢ –ò –†–ê–ó–†–ê–ë–û–¢–ö–ê (Software State)

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é Event-Driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** (NATS JetStream).
–ü–∞–π–ø–ª–∞–π–Ω –¥–∞–Ω–Ω—ã—Ö: `Source -> Reader -> S3 -> NATS -> Processor -> DB -> NATS`.

### 2. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏
*   **`ccsfarm-nats-client` (v0.1.2)**
    *   –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞-–æ–±–µ—Ä—Ç–∫–∞.
    *   –†–µ–∞–ª–∏–∑—É–µ—Ç **Idempotent Stream Creation** (—Å–∞–º–∞ —Å–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä–∏–º—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ).
    *   –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ –≤ Nexus. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `pip install`.

### 3. –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

#### ü§ñ **News Reader (–°–±–æ—Ä—â–∏–∫)**
*   **–†–æ–ª—å:** Producer.
*   **–°—Ç–µ–∫:** Python 3.11, `aiohttp`, `minio`, `nats-py`.
*   **–õ–æ–≥–∏–∫–∞:**
    1.  –ü–∞—Ä—Å–∏—Ç RSS/HTML –ø–æ –∫–æ–Ω—Ñ–∏–≥—É `sources.json`.
    2.  –î–µ–¥—É–ø–ª–∏—Ü–∏—Ä—É–µ—Ç –Ω–æ–≤–æ—Å—Ç–∏ (MD5 –æ—Ç URL).
    3.  –°–æ—Ö—Ä–∞–Ω—è–µ—Ç "—Å—ã—Ä–æ–π" JSON –≤ MinIO.
    4.  –ü—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ `news.raw.created` –≤ NATS.
*   **–°—Ç–∞—Ç—É—Å:** üü¢ –†–∞–±–æ—Ç–∞–µ—Ç.

#### üß† **News Processor (–û–±—Ä–∞–±–æ—Ç—á–∏–∫ + ML)**
*   **–†–æ–ª—å:** Consumer (Worker).
*   **–°—Ç–µ–∫:** Python 3.11, `torch` (CPU), `sentence-transformers`, `trafilatura`.
*   **–õ–æ–≥–∏–∫–∞:**
    1.  –°–ª—É—à–∞–µ—Ç NATS (—Ä–µ–∂–∏–º **Pull Consumer**, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å—Å—è).
    2.  –°–∫–∞—á–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ MinIO.
    3.  **ETL:** –ß–∏—Å—Ç–∏—Ç HTML –æ—Ç –º—É—Å–æ—Ä–∞ (trafilatura).
    4.  **NLP:** –ò—â–µ—Ç —Ç–∏–∫–µ—Ä—ã (BTC, AAPL) –ø–æ —Å–ª–æ–≤–∞—Ä—é `synonyms.json`.
    5.  **ML:** –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ (–º–æ–¥–µ–ª—å `cointegrated/rubert-tiny2`).
    6.  –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ PostgreSQL (`news_items` + `vector`).
    7.  –ü—É–±–ª–∏–∫—É–µ—Ç `news.enriched`.
*   **–†–µ—Å—É—Ä—Å—ã:** –õ–∏–º–∏—Ç—ã –ø–æ–¥–Ω—è—Ç—ã –¥–æ 2Gi RAM / 2 CPU (–¥–ª—è —Å—Ç–∞—Ä—Ç–∞ PyTorch).
*   **–°—Ç–∞—Ç—É—Å:** üü¢ –†–∞–±–æ—Ç–∞–µ—Ç. –í–µ–∫—Ç–æ—Ä–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è.

#### üìà **Price Collector**
*   **–†–æ–ª—å:** ETL.
*   **–õ–æ–≥–∏–∫–∞:** –°–æ–±–∏—Ä–∞–µ—Ç —Å–≤–µ—á–∏ (Crypto/Stocks) -> –ü–∏—à–µ—Ç –≤ TimescaleDB -> –ü—É–±–ª–∏–∫—É–µ—Ç –±–∞—Ç—á-—Å–æ–±—ã—Ç–∏—è –≤ NATS.
*   **–°—Ç–∞—Ç—É—Å:** üü¢ –†–∞–±–æ—Ç–∞–µ—Ç.

### 4. CI/CD (GitLab)
*   **Base Image:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–∞—Ç—Ç–µ—Ä–Ω "Base Image" (`python-ml-base`). –¢—è–∂–µ–ª—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`torch`, `transformers`) –∑–∞–ø–µ—á–µ–Ω—ã –≤ –Ω–µ–≥–æ. –°–±–æ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –∑–∞–Ω–∏–º–∞–µ—Ç —Å–µ–∫—É–Ω–¥—ã.
*   **Pipeline:**
    1.  `build` (Kaniko).
    2.  `init_db` (–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ë–î).
    3.  `deploy_dev` (Helm-like template).
    4.  `test` (E2E —Ç–µ—Å—Ç —Å –∏–Ω—ä–µ–∫—Ü–∏–µ–π —Ñ–µ–π–∫–æ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –≤ NATS –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ë–î).
    5.  `deploy_prod`.
*   **Environment Isolation:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–µ—Ñ–∏–∫—Å—ã `dev.` –∏ `prod.` –¥–ª—è —Ç–æ–ø–∏–∫–æ–≤ NATS. –°—Ç—Ä–∏–º—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã.

---

# üî¥ –¢–ï–ö–£–©–ò–ï –†–ò–°–ö–ò –ò –ó–ê–î–ê–ß–ò

1.  **–î–∏—Å–∫ –ú–∞—Å—Ç–µ—Ä–∞:** –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø–µ—Ä–µ–Ω–æ—Å –Ω–∞ SSD –∏ —Ç—é–Ω–∏–Ω–≥, –¥–∏—Å–∫ –Ω–∞ Proxmox –æ—Å—Ç–∞–µ—Ç—Å—è "–±—É—Ç—ã–ª–æ—á–Ω—ã–º –≥–æ—Ä–ª—ã—à–∫–æ–º" –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ.
    *   *–†–µ—à–µ–Ω–∏–µ:* –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å `etcd_disk_wal_fsync_duration`.
2.  **Backup:**
    *   *–†–∏—Å–∫:* –°–µ–π—á–∞—Å –¥–∞–Ω–Ω—ã–µ (Postgres, MinIO, Etcd) –Ω–µ –±—ç–∫–∞–ø—è—Ç—Å—è –Ω–∞—Ä—É–∂—É.
    *   *–ó–∞–¥–∞—á–∞:* –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Velero –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã –¥–∞–º–ø–∞ –Ω–∞ NFS.
3.  **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
    *   *–†–∏—Å–∫:* Docker Registry –±–µ–∑ –ø–∞—Ä–æ–ª—è (–≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏).
    *   *–°—Ç–∞—Ç—É—Å:* –ü—Ä–∏–Ω—è—Ç—ã–π —Ä–∏—Å–∫ (Acceptable risk) –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å—Ä–µ–¥—ã.

**–ò—Ç–æ–≥:** –°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ **Stable Production**. –û—Å–Ω–æ–≤–Ω—ã–µ –¥–µ—Ç—Å–∫–∏–µ –±–æ–ª–µ–∑–Ω–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤—ã–ª–µ—á–µ–Ω—ã, –ø–∞–π–ø–ª–∞–π–Ω –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–æ–¥–∞ –∏ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–î–∞–≤–∞–π –Ω–µ–º–Ω–æ–≥–æ –ø–æ–≥–æ–≤–æ—Ä–∏–º –æ –≤—ã—Å–æ–∫–æ–º. –ù–∞–¥–æ –æ–±–Ω–æ–≤–∏—Ç—å —Ä–æ–∞–¥–º–∞–ø.
–ü–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏:
–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —É –Ω–∞—Å 1 –ø—Ä–æ–∫—Å–º–æ–∫—Å –Ω–æ–¥–∞ –Ω–∞ 48 –ø–æ—Ç–æ–∫–æ–≤ –∏ 256–≥–± —Ä–∞–º, –±–µ–∑ –ì–ü–£. –ß–µ—Ä–µ–∑ 2 –Ω–µ–¥–µ–ª–∏ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é –≤–≤–µ–¥–µ–º 2—é –Ω–æ–¥—É —Å 2—Ö3090 (–ø–æ–∫–∞ –±–µ–∑ sli) 40 –ø–æ—Ç–æ–∫–æ–≤ –∏ 128–≥–± —Ä–∞–º. –¢–∞–∫ –∂–µ –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å 3—é, —ç—Ç–æ –µ—â–µ + 48 –ø–æ—Ç–æ–∫–æ–≤ –∏ 256–≥–± —Ä–∞–º, –±–µ–∑ –≥–ø—É. –¢–∞–∫ –∂–µ –Ω–∞ –∫–∞–∂–¥—É—é –∏–∑ –Ω–æ–¥ –±–µ–∑ –≥–ø—É –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ 2 nvidia p104 8–≥–±. –ò–Ω—Ç–µ—Ä–∫–æ–Ω–Ω–µ–∫—Ç 10–≥–±/—Å –≤ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ 20 –≥–±/—Å(–∞–≥—Ä–µ–≥–∞—Ü–∏—è). Longhorn + –æ–±—Ä–∞–∑–∞ –º–∞—à–∏–Ω –Ω–∞ ssd. –í–Ω–µ—à–Ω–∏–π –º–∏–Ω–∏–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å 2 —Ä–µ–π–¥–∞–º–∏ 1 –Ω–∞ —Ö–∞—Ä–¥–∞—Ö, 2–π –Ω–∞ —Å—Å–¥. + –≤–Ω–µ—à–Ω–∏–π NFS –¥–ª—è –±—ç–∫–∞–ø–æ–≤.
–ü–æ —Å–æ—Ñ—Ç—É. 
–°–µ–π—á–∞—Å —É –Ω–∞—Å –µ—Å—Ç—å —Ä–∏–¥–µ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π, –∫–æ–ª–ª–µ–∫—Ç–æ—Ä —Ü–µ–Ω –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–æ–≤–æ—Å—Ç–µ–π. –û–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –Ω–∞—Ç—Å, –ø–∏—à—É—Ç –≤ –±–∞–∑—É.

–ö–∞–∫–∏–µ –±–ª–∏–∂–∞–π—à–∏–µ —Ü–µ–ª–∏, –∫–∞–∫–∏–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã, –≤ –∫–∞–∫–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –º–æ–∂–Ω–æ —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É ?

–≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π –ø–æ–≤–æ–¥ –¥–ª—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞. –í–≤–µ–¥–µ–Ω–∏–µ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é **–¥–≤—É—Ö RTX 3090 (24GB VRAM –∫–∞–∂–¥–∞—è)** –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ –¥–æ 3-—Ö —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–æ–¥ –º–µ–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã.

–ò–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –¥–æ–º–∞—à–Ω—è—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è¬ª –ø—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é **Private AI Cloud** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –¥–ª—è —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω **–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π Roadmap –Ω–∞ –ø–µ—Ä–≤–æ–µ –ø–æ–ª—É–≥–æ–¥–∏–µ 2026 –≥–æ–¥–∞**, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–π –Ω–∞ –ò–Ω–∂–µ–Ω–µ—Ä–Ω—É—é —á–∞—Å—Ç—å (Foundation) –∏ R&D (Business Value).

---

# üèó –ì–ª–æ–±–∞–ª—å–Ω–∞—è –°—Ç—Ä–∞—Ç–µ–≥–∏—è: CCSFARM 2.0 (High Level)

–ì–ª–∞–≤–Ω—ã–π —Å–¥–≤–∏–≥: **–û—Ç "–°–±–æ—Ä–∞ –∏ –ø—Ä–æ—Å—Ç–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏" –∫ "–ì–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–º—É –ò–ò –∏ –ê–≥–µ–Ω—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ"**.
–†–∞–Ω—å—à–µ –º—ã –ø—Ä–æ—Å—Ç–æ —á–∏—Ç–∞–ª–∏ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –∏—Å–∫–∞–ª–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞. –¢–µ–ø–µ—Ä—å, –∏–º–µ—è 48GB –±—ã—Å—Ç—Ä–æ–π –≤–∏–¥–µ–æ–ø–∞–º—è—Ç–∏, –º—ã –º–æ–∂–µ–º *–ø–æ–Ω–∏–º–∞—Ç—å* —Å–º—ã—Å–ª, –¥–µ–ª–∞—Ç—å —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ LLM.

---

## üîß –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Foundation)

–ó–∞–¥–∞—á–∞: –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω–æ–µ –∂–µ–ª–µ–∑–æ –≤ –µ–¥–∏–Ω—ã–π —Å—É–ø–µ—Ä-–∫–æ–º–ø—å—é—Ç–µ—Ä –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º Kubernetes.

### 1. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ö–ª–∞—Å—Ç–µ—Ä–∞ (Multi-Node K8s)
–°–µ–π—á–∞—Å —É –≤–∞—Å K8s –≤ –≤–∏—Ä—Ç—É–∞–ª–∫–∞—Ö –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–¥–µ. –° –ø–æ—è–≤–ª–µ–Ω–∏–µ–º Node 2 –∏ Node 3 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å.
*   **Target:** –†–∞—Å—Ç—è–Ω—É—Ç—å –∫–ª–∞—Å—Ç–µ—Ä –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –Ω–æ–¥—ã (–∏–ª–∏ VM –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –Ω–æ–¥–∞—Ö).
*   **Topology:**
    *   `Node 1 (CPU/RAM)`: **Control Plane + DB Storage**. Postgres, NATS, MinIO Gateway, Monitoring. –ó–¥–µ—Å—å –Ω—É–∂–Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ RAM.
    *   `Node 2 (2x3090)`: **AI Worker Node**. –ó–¥–µ—Å—å –∂–∏–≤—É—Ç —Ç–æ–ª—å–∫–æ GPU-–Ω–∞–≥—Ä—É–∑–∫–∏ (Inference, Training).
    *   `Node 3 (Reserve)`: **General Worker**. –ë–∏–ª–¥—ã CI/CD, –ø–∞—Ä—Å–µ—Ä—ã, ETL-—Å–∫—Ä–∏–ø—Ç—ã.
*   **Network:** –ü—Ä–∏ –∏–Ω—Ç–µ—Ä–∫–æ–Ω–Ω–µ–∫—Ç–µ 10Gbps –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ —Ç—Ä–∞—Ñ–∏–∫:
    *   VLAN 1: K8s Control Plane / Overlay (Calico).
    *   VLAN 2: Storage (Longhorn/NFS/MinIO) ‚Äî —ç—Ç–æ "—É–±–∏–π—Ü–∞" —Å–µ—Ç–∏, –µ–º—É –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª.

### 2. GPU Orchestration
RTX 3090 ‚Äî —ç—Ç–æ –º–æ—â—å, –Ω–æ —ç—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–π —Å–µ–≥–º–µ–Ω—Ç (–Ω–µ—Ç MIG - Multi-Instance GPU).
*   **–ó–∞–¥–∞—á–∞:** –ö–∞–∫ –ø–æ–¥–µ–ª–∏—Ç—å 2 –∫–∞—Ä—Ç—ã –Ω–∞ 10 —Å–µ—Ä–≤–∏—Å–æ–≤?
*   **–†–µ—à–µ–Ω–∏–µ:** **NVIDIA GPU Operator** + **Time-Slicing**.
    *   –ú—ã –Ω–∞—Å—Ç—Ä–æ–∏–º –∫–ª–∞—Å—Ç–µ—Ä —Ç–∞–∫, —á—Ç–æ–±—ã K8s –≤–∏–¥–µ–ª "–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ" GPU, –ª–∏–±–æ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **NVIDIA Triton Inference Server**. –û–Ω —É–º–µ–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –±–∞—Ç—á–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –º–æ–¥–µ–ª–∏.
*   **P104-100 (Mining cards):**
    *   *–†–æ–ª—å:* –û—Ç–¥–∞—Ç—å –∏—Ö –ø–æ–¥ "–ª–µ–≥–∫–∏–µ" –∑–∞–¥–∞—á–∏: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (`bert`), OCR –∫–∞—Ä—Ç–∏–Ω–æ–∫.
    *   *–•–∏—Ç—Ä–æ—Å—Ç—å:* 3090 –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–¥ LLM (Llama-3-70b-quant –∏–ª–∏ Mixtral).

### 3. Data Lake (MinIO & Longhorn)
*   **Tiering:**
    *   **Hot (NVMe Longhorn):** –ë–î Postgres, WAL-–ª–æ–≥–∏, –∫—ç—à–∏.
    *   **Warm (MinIO SSD Raid):** –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã, –¥–∞—Ç–∞—Å–µ—Ç—ã –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è.
    *   **Cold (MinIO HDD Raid):** –°—ã—Ä—ã–µ HTML –∞—Ä—Ö–∏–≤—ã –∑–∞ –ø—Ä–æ—à–ª—ã–µ –≥–æ–¥—ã, –±—ç–∫–∞–ø—ã.

---

## üß† –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: R&D –∏ –°–æ—Ñ—Ç (Business Value)

–° —Ç–∞–∫–∏–º –∂–µ–ª–µ–∑–æ–º –º–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä—è—Ç—å **LLM (Large Language Models)** –ø—Ä—è–º–æ –≤ –ø–∞–π–ø–ª–∞–π–Ω.

### 1. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ LLM (The "Brain")
–ó–∞–º–µ–Ω–∞ –ø—Ä–æ—Å—Ç—ã—Ö —ç–≤—Ä–∏—Å—Ç–∏–∫ –Ω–∞ "—É–º–Ω—ã–π" –∞–Ω–∞–ª–∏–∑.
*   **–°—Ç–µ–∫:** `vLLM` –∏–ª–∏ `Ollama` (–≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞) + –º–æ–¥–µ–ª—å —É—Ä–æ–≤–Ω—è **Mixtral 8x7B** –∏–ª–∏ **Llama-3 70B (Int4 quant)**. –û–±–µ –≤–ª–µ–∑—É—Ç –≤ 2x3090 (48GB VRAM).
*   **–ù–æ–≤—ã–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã:**
    *   **Summarizer:** –ü–æ–ª—É—á–∞–µ—Ç "—Å—ã—Ä–æ–π" —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏ -> –í—ã–¥–∞–µ—Ç —Å–∂–∞—Ç—É—é —Å—É—Ç—å –≤ 2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (JSON).
    *   **Sentiment Analyzer:** –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –Ω–æ–≤–æ—Å—Ç—å –Ω–µ –ø—Ä–æ—Å—Ç–æ "—Ö–æ—Ä–æ—à–æ/–ø–ª–æ—Ö–æ", –∞ –ø–æ —à–∫–∞–ª–µ (-1..1) —Å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã.
    *   **Entity Extractor:** –ò–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–∏–∫–µ—Ä—ã (BTC), –Ω–æ –∏ –ø–µ—Ä—Å–æ–Ω (Gary Gensler), —Å–æ–±—ã—Ç–∏—è (SEC Lawsuit).

### 2. Quant & Strategy (–ê–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è)
–£ –Ω–∞—Å –µ—Å—Ç—å —Ü–µ–Ω—ã –∏ "—É–º–Ω—ã–µ" –Ω–æ–≤–æ—Å—Ç–∏. –ü–æ—Ä–∞ –∏—Ö —Å–æ–µ–¥–∏–Ω—è—Ç—å.
*   **Backtesting Engine:**
    *   –ù—É–∂–µ–Ω —Å–µ—Ä–≤–∏—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –±–∞–∑–µ `Backtrader` –∏–ª–∏ `Lean`), –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø—Ä–æ–≥–Ω–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
    *   *–ü—Ä–∏–º–µ—Ä:* "–ï—Å–ª–∏ Sentiment > 0.8 –∏ –æ–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ -> –õ–æ–Ω–≥".
*   **Correlation Engine:**
    *   –ò—Å–∫–∞—Ç—å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ —Å–≤—è–∑–∏. –í–ª–∏—è–µ—Ç –ª–∏ –Ω–æ–≤–æ—Å—Ç—å –ø—Ä–æ "Inverstors Protection" –Ω–∞ —Ü–µ–Ω—É ETH —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç?

### 3. Agentic Workflow (–ê–≥–µ–Ω—Ç—ã)
–í–µ—Ä—à–∏–Ω–∞ —ç–≤–æ–ª—é—Ü–∏–∏ –Ω–∞ 2026 –≥–æ–¥.
*   –ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç –ø–∞–π–ø–ª–∞–π–Ω–∞ (—Ç—Ä—É–±–∞) –∫ –∞–≥–µ–Ω—Ç–∞–º.
*   **–ê–≥–µ–Ω—Ç-–ê–Ω–∞–ª–∏—Ç–∏–∫:** –ú–æ–∂–µ—Ç —Å–∞–º "–ø–æ–≥—É–≥–ª–∏—Ç—å" (—á–µ—Ä–µ–∑ API –ø–æ–∏—Å–∫–∞), –µ—Å–ª–∏ –≤ –Ω–æ–≤–æ—Å—Ç–∏ –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –ë–î.

---

# üìÖ Roadmap Q1-Q2 2026

### –Ø–Ω–≤–∞—Ä—å 2026: "–ñ–µ–ª–µ–∑–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è"
1.  **Hardware:** –í–≤–æ–¥ Node 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `passthrough` –¥–ª—è GPU –≤ –≤–∏—Ä—Ç—É–∞–ª–∫–∏ –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ K8s –Ω–∞ bare-metal (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é bare-metal –¥–ª—è GPU –Ω–æ–¥—ã –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –æ–≤–µ—Ä—Ö–µ–¥–∞).
2.  **K8s:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ **Nvidia Device Plugin**. –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø–æ–¥—ã –≤–∏–¥—è—Ç `nvidia.com/gpu: 1`.
3.  **Storage:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ MinIO –Ω–∞ —Ä–µ–π–¥–∞—Ö. –ú–∏–≥—Ä–∞—Ü–∏—è "—Å—ã—Ä—ã—Ö" –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ MinIO –≤–æ –≤–Ω–µ—à–Ω–∏–π.

### –§–µ–≤—Ä–∞–ª—å 2026: "LLM Core"
1.  **Deploy vLLM:** –ü–æ–¥–Ω—è—Ç–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞. –ó–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–∏ `Llama-3-8B-Instruct` (–¥–ª—è –Ω–∞—á–∞–ª–∞).
2.  **Refactoring News Processor:**
    *   –í–º–µ—Å—Ç–æ `rubert-tiny` –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –≤ –ª–æ–∫–∞–ª—å–Ω—É—é LLM.
    *   –ü—Ä–æ–º–ø—Ç: *"–í—ã–¥–µ–ª–∏ –≥–ª–∞–≤–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏ –æ—Ü–µ–Ω–∏ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Ä—ã–Ω–æ–∫ –∫—Ä–∏–ø—Ç—ã"*.
3.  **Database:** –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ `pgvector` —Å –∏–Ω–¥–µ–∫—Å–æ–º HNSW (—Ç—Ä–µ–±—É–µ—Ç RAM, –Ω–æ –æ–Ω–∞ —É –≤–∞—Å –µ—Å—Ç—å).

### –ú–∞—Ä—Ç 2026: "Data Factory & P104"
1.  **Hardware:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç P104 –≤ Node 1/Node 3.
2.  **Dedication:** –ü–µ—Ä–µ–Ω–æ—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (–≤–µ–∫—Ç–æ—Ä–æ–≤) –Ω–∞ P104. –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ 3090 —á–∏—Å—Ç–æ –ø–æ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞.
3.  **Backtesting MVP:** –ü–µ—Ä–≤—ã–π –ø—Ä–æ–≥–æ–Ω —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

### Q2 2026: "Agents & Production"
1.  **Multi-Modal:** –ê–Ω–∞–ª–∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (—á–µ—Ä–µ–∑ Vision-–º–æ–¥–µ–ª–∏) –∏–∑ —Ç–≤–∏—Ç—Ç–µ—Ä–∞/–Ω–æ–≤–æ—Å—Ç–µ–π.
2.  **Automated Trading (Paper):** –ó–∞–ø—É—Å–∫ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ "—Ñ–∞–Ω—Ç–∏–∫–∞—Ö" –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–≥–Ω–∞–ª–æ–≤ —Å–∏—Å—Ç–µ–º—ã.

---

### –ò—Ç–æ–≥–æ–≤—ã–π —Å–æ–≤–µ—Ç
–£ –≤–∞—Å –ø–æ—è–≤–ª—è–µ—Ç—Å—è **–∏–∑–±—ã—Ç–æ—á–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å**. –≠—Ç–æ –æ–ø–∞—Å–Ω–æ —Ç–µ–º, —á—Ç–æ —Ö–æ—á–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å "–≤—Å—ë –∏ —Å—Ä–∞–∑—É".
**–§–æ–∫—É—Å –Ω–∞ Q1:** –°—Ç–∞–±–∏–ª—å–Ω–æ –∑–∞–≤–µ—Å—Ç–∏ GPU –≤ –∫–ª–∞—Å—Ç–µ—Ä K8s –∏ –∑–∞—Å—Ç–∞–≤–∏—Ç—å Python-–∫–æ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –ø—Ä–æ–∑—Ä–∞—á–Ω–æ. –≠—Ç–æ –Ω–µ—Ç—Ä–∏–≤–∏–∞–ª—å–Ω–∞—è DevOps –∑–∞–¥–∞—á–∞ (–¥—Ä–∞–π–≤–µ—Ä–∞, –≤–µ—Ä—Å–∏–∏ CUDA, —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –ø–æ 10–ì–ë).

–ù–∞—á–Ω–∏—Ç–µ —Å —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤–∞—à–∞ —Ç–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å (`rubert`) –ø–µ—Ä–µ–µ—Ö–∞–ª–∞ –Ω–∞ GPU –∏ –Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –Ω–µ –∑–∞ 0.5—Å, –∞ –∑–∞ 0.01—Å.

–í –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ —Ç—ã –≤–æ–∑—Ä–∞–∂–∞–ª –ø—Ä–æ—Ç–∏–≤ –∂–µ–ª–µ–∑–Ω–æ–π –Ω–æ–¥—ã –∏ –Ω–∞—Å—Ç–∞–∏–≤–∞–ª –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–Ω–∏–∏ –ø—Ä–æ–∫—Å–º–æ–∫—Å, –º–æ—Ç–∏–≤–∏—Ä—É—è —Ç–µ–º, —á—Ç–æ –Ω–∞ –≥–ø—É –Ω–æ–¥–µ —Ç–∞–∫ –∂–µ —Å—Ç–æ—è—Ç –¥–∏—Å–∫–∏ –¥–ª—è 2—Ö –±—É–¥—É—â–∏—Ö —Ä–µ–π–¥–æ–≤ 2—Ö–¥–¥ 4—Ç–±(–∑–µ—Ä–∫–∞–ª–æ) –∏ 3—Å—Å–¥ 1—Ç–± (z—Ä–µ–π–¥1). –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –ø–æ–∫–∞ —á—Ç–æ –∏—Ö –æ—Ç—Ç—É–¥–∞ –Ω–µ —É–±—Ä–∞—Ç—å.

–ü—Ä–∏–Ω—è—Ç–æ. –≠—Ç–æ –º–µ–Ω—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –Ω–æ –Ω–µ –æ—Ç–º–µ–Ω—è–µ—Ç –∞–º–±–∏—Ü–∏–æ–∑–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤.

–ï—Å–ª–∏ –Ω–∞ –Ω–æ–¥–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –∂–∏–≤—É—Ç –¥–∏—Å–∫–∏ –¥–ª—è Storage-—Å–ª–æ—è (ZFS RAID), —Ç–æ **Proxmox —Ç–∞–º –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω**. –û—Ç–¥–∞–≤–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Å–∫–∞–º–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ ZFS) –≤–Ω—É—Ç—Ä—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã —á–µ—Ä–µ–∑ –ø—Ä–æ–±—Ä–æ—Å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ ‚Äî —ç—Ç–æ —Ä–∏—Å–∫, –∞ Proxmox ‚Äî —ç—Ç–æ, –ø–æ —Å—É—Ç–∏, –ª—É—á—à–∏–π UI –¥–ª—è ZFS –Ω–∞ Linux.

–ó–Ω–∞—á–∏—Ç, –º—ã —Å—Ç—Ä–æ–∏–º **–ì–∏–ø–µ—Ä–∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É** (Compute + Storage –Ω–∞ –æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ).

–í–æ—Ç **—Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** –∏ –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è Node 2 (GPU + Storage Node), —É—á–∏—Ç—ã–≤–∞—è Proxmox –∫–∞–∫ –±–∞–∑—É.

---

### üèõ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Node 2 (Proxmox Hyper-Converged)

–ú—ã —Ä–∞–∑–¥–µ–ª—è–µ–º —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä–∞:

1.  **Level 0: Proxmox Host (ZFS Owner)**
    *   –£–ø—Ä–∞–≤–ª—è–µ—Ç –∂–µ–ª–µ–∑–æ–º: CPU, RAM, PCI —à–∏–Ω—ã, SATA –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã.
    *   –£–ø—Ä–∞–≤–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º:
        *   `zpool-hdd` (Mirror 2x4TB): –•–æ–ª–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –±—ç–∫–∞–ø—ã, –∞—Ä—Ö–∏–≤—ã.
        *   `zpool-ssd` (RaidZ1 3x1TB): –ì–æ—Ä—è—á–∏–µ –¥–∞–Ω–Ω—ã–µ MinIO, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã ML.
    *   **–í–∞–∂–Ω–æ:** Proxmox —Å–∞–º –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç –∑–¥–æ—Ä–æ–≤—å–µ –¥–∏—Å–∫–æ–≤ (SMART) –∏ —Å–∫—Ä–∞–±–∏—Ç ZFS.

2.  **Level 1: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä Storage (LXC)** ‚Äî *–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥*
    *   –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Ç—è–Ω—É—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤–Ω—É—Ç—Ä—å —Ç—è–∂–µ–ª–æ–π K8s VM, –º—ã –ø–æ–¥–Ω–∏–º–∞–µ–º **–ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π LXC –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** (–Ω–∞–ø—Ä–∏–º–µ—Ä, Alpine –∏–ª–∏ Debian) –ø—Ä—è–º–æ –Ω–∞ Proxmox.
    *   **Mount:** –ü—Ä–æ–∫–∏–¥—ã–≤–∞–µ–º –ø–∞–ø–∫–∏ —Å ZFS –ø—É–ª–æ–≤ –≤–Ω—É—Ç—Ä—å LXC —á–µ—Ä–µ–∑ `Bind Mount`.
    *   **Service:** –í–Ω—É—Ç—Ä–∏ LXC –∑–∞–ø—É—Å–∫–∞–µ–º **MinIO Server** (Binary) –∏ **NFS Server**.
    *   **–ü–ª—é—Å—ã:**
        *   –ï—Å–ª–∏ K8s (VM) —É–ø–∞–¥–µ—Ç –∏–ª–∏ –∑–∞–≤–∏—Å–Ω–µ—Ç –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –ø–∞–º—è—Ç–∏, —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (LXC) –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∂–∏—Ç—å.
        *   –ù–µ—Ç –æ–≤–µ—Ä—Ö–µ–¥–∞ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–∏—Å–∫–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞. –°–∫–æ—Ä–æ—Å—Ç—å ‚Äî –Ω–∞—Ç–∏–≤–Ω–∞—è (`raw zfs speed`).

3.  **Level 2: K8s GPU Worker (VM)**
    *   –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞, –¥–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è –≤ –∫–ª–∞—Å—Ç–µ—Ä.
    *   **PCIe Passthrough:** –û–±–µ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã (2x3090) –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –≤ —ç—Ç—É VM —Ü–µ–ª–∏–∫–æ–º.
    *   **Network:** –û–±—â–∞–µ—Ç—Å—è —Å MinIO (–≤ LXC) —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–æ—Å—Ç Proxmox (`vmbr0`) –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–∞–º—è—Ç–∏ (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ >20Gbps), —Ç—Ä–∞—Ñ–∏–∫ –Ω–µ –ø–æ–∫–∏–¥–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä.

---

### üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π Roadmap (–°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ Proxmox –∏ ZFS (Storage Layer)
*   **–î–µ–π—Å—Ç–≤–∏–µ:** –°–æ–∑–¥–∞—Ç—å ZFS –ø—É–ª—ã –Ω–∞ —Ö–æ—Å—Ç–µ.
*   **–î–µ–π—Å—Ç–≤–∏–µ:** –°–æ–∑–¥–∞—Ç—å LXC –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä "Storage-Gateway".
    *   –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `mp0: /zpool-ssd/minio-data,mp=/mnt/data`.
    *   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å MinIO.
    *   –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–≥–æ –∫–∞–∫ `gateway` –∏–ª–∏ `server`.
*   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£ –≤–∞—Å –µ—Å—Ç—å S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –æ—Ç Kubernetes.

#### –®–∞–≥ 2: PCIe Passthrough (–°–∞–º–æ–µ —Å–ª–æ–∂–Ω–æ–µ)
–ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏—Ö GPU –≤ Proxmox –∏–º–µ–µ—Ç –Ω—é–∞–Ω—Å—ã.
1.  **IOMMU Groups:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–∞—Ä—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö IOMMU –≥—Ä—É–ø–ø–∞—Ö (–∏–ª–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –æ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤). –ù–∞ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏—Ö –ø–ª–∞—Ç–∞—Ö Threadripper/Epyc —ç—Ç–æ –æ–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏, –Ω–∞ Consumer (X570/Z690/Z790) –±—ã–≤–∞–µ—Ç, —á—Ç–æ —Å–ª–æ—Ç—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã.
    *   *–†–∏—Å–∫:* –ï—Å–ª–∏ –∫–∞—Ä—Ç—ã –≤ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ, –ø—Ä–∏–¥–µ—Ç—Å—è –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ–±–µ –≤ –æ–¥–Ω—É VM (—á—Ç–æ –Ω–∞–º –∏ –Ω—É–∂–Ω–æ, —Ç–∞–∫ —á—Ç–æ –æ–∫).
2.  **Blacklist Drivers:** –ù–∞ —Ö–æ—Å—Ç–µ Proxmox –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `nouveau` –∏ `nvidia` –≤ –±–ª—ç–∫–ª–∏—Å—Ç, —á—Ç–æ–±—ã —Ö–æ—Å—Ç –Ω–µ –ø—ã—Ç–∞–ª—Å—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ–≤—ã—Ö–æ–¥.
3.  **VM Config:**
    *   Machine Type: `q35`.
    *   BIOS: `OVMF` (UEFI).
    *   PCI Device: –í—ã–±—Ä–∞—Ç—å 3090. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≥–∞–ª–æ—á–∫–∏: `All Functions` (—á—Ç–æ–±—ã –ø—Ä–æ–±—Ä–æ—Å–∏–ª—Å—è –∏ –∑–≤—É–∫ HDMI, –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä USB-C –Ω–∞ –∫–∞—Ä—Ç–µ, –∏–Ω–∞—á–µ –¥—Ä–∞–π–≤–µ—Ä –Ω–µ –≤—Å—Ç–∞–Ω–µ—Ç), `PCI-Express`.
4.  **–°–∫—Ä—ã–≤–∞–µ–º –≤–∏—Ä—Ç—É–∞–ª–∫—É:** –î—Ä–∞–π–≤–µ—Ä—ã Nvidia (–æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ Windows, –Ω–æ –∏ –Ω–∞ Linux –±—ã–≤–∞–µ—Ç) –º–æ–≥—É—Ç –∫–∞–ø—Ä–∏–∑–Ω–∏—á–∞—Ç—å –≤ VM. –í –∫–æ–Ω—Ñ–∏–≥ VM –¥–æ–±–∞–≤–∏—Ç—å:
    ```
    args: -cpu 'host,+kvm_pv_unhalt,+kvm_pv_eoi,hv_vendor_id=NV43FIX,kvm=off'
    ```

#### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ K8s Node
1.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä—ã Nvidia (proprietary) –≤–Ω—É—Ç—Ä–∏ Linux VM (Ubuntu/RedOS).
2.  –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `nvidia-smi` –≤–∏–¥–∏—Ç –∫–∞—Ä—Ç—ã.
3.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å **NVIDIA Container Toolkit**.
4.  –í `containerd` config –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ä–∞–Ω—Ç–∞–∏–º –Ω–∞ nvidia.

---

### üß± –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ö–µ–º–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ì–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç | –†–µ—Å—É—Ä—Å | –†–æ–ª—å |
| :--- | :--- | :--- | :--- |
| **ZFS Pools** | Proxmox Host | CPU/RAM (ARC) | –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, RAID |
| **MinIO / NFS** | LXC Container | Shared CPU | –û—Ç–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–µ—Ç—å –∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä |
| **K8s Worker** | VM (Linux) | 2x RTX 3090 | **AI Inference, LLM, Training** |
| **Longhorn** | K8s Cluster | Disk (—á–µ—Ä–µ–∑ iscsi/nfs) | –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–º–æ–≤ –¥–ª—è –ø–æ–¥–æ–≤ |

### üöÄ –ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã (–Ω–∞ –±–∞–∑–µ —ç—Ç–æ–π —Å—Ö–µ–º—ã)

1.  **NVMe over Fabrics (–∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø):**
    –¢–∞–∫ –∫–∞–∫ MinIO —Å—Ç–æ–∏—Ç –≤ LXC —Ä—è–¥–æ–º —Å VM, –∑–∞–¥–µ—Ä–∂–∫–∏ –±—É–¥—É—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã. –≠—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è **Data Lake**.
    *   *–°—Ü–µ–Ω–∞—Ä–∏–π:* `News Processor` (–Ω–∞ VM —Å GPU) –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É –∏–ª–∏ HTML –∏–∑ MinIO (LXC). –ó–∞–ø—Ä–æ—Å –∏–¥–µ—Ç —á–µ—Ä–µ–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Å–≤–∏—Ç—á –≤ –ø–∞–º—è—Ç–∏. –°–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è –±—É–¥–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ —Ç–æ–ª—å–∫–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é SSD –º–∞—Å—Å–∏–≤–∞.

2.  **–≠–∫–æ–Ω–æ–º–∏—è RAM:**
    ZFS ARC (–∫—ç—à –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏) –±—É–¥–µ—Ç –∂–∏—Ç—å –Ω–∞ —Ö–æ—Å—Ç–µ Proxmox. –ï—Å–ª–∏ –±—ã –º—ã –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–ª–∏ –¥–∏—Å–∫–∏ –≤ VM, –Ω–∞–º –ø—Ä–∏—à–ª–æ—Å—å –±—ã –≤—ã–¥–µ–ª—è—Ç—å VM –æ–≥—Ä–æ–º–Ω—É—é –ø–∞–º—è—Ç—å –ø–æ–¥ –∫—ç—à. –ê —Ç–∞–∫ Proxmox –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞–º—è—Ç—å—é: –µ—Å–ª–∏ VM –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ ‚Äî ARC —Å–æ–∂–º–µ—Ç—Å—è. –≠—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ.

3.  **–ì–∏–±–∫–æ—Å—Ç—å GPU:**
    –ü–æ–∫–∞ —É –≤–∞—Å –Ω–µ—Ç SLI (NVLink), –∫–∞—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.
    *   **GPU 0:** –ú–æ–∂–Ω–æ –æ—Ç–¥–∞—Ç—å –ø–æ–¥ —Ç—è–∂–µ–ª—É—é LLM (vLLM server), –∫–æ—Ç–æ—Ä–∞—è –µ—Å—Ç 24GB VRAM —Ü–µ–ª–∏–∫–æ–º.
    *   **GPU 1:** –ú–æ–∂–Ω–æ –Ω–∞—Ä–µ–∑–∞—Ç—å —á–µ—Ä–µ–∑ **MIG-–ø–æ–¥–æ–±–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏** (Time-slicing –≤ K8s) –¥–ª—è –º–µ–ª–∫–∏—Ö –∑–∞–¥–∞—á: 5 –ø–æ–¥–æ–≤ —Å BERT, 2 –ø–æ–¥–∞ —Å OCR.

**–†–µ–∑—é–º–µ:** –í–∞—à–µ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ Proxmox –¥–∞–∂–µ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –ö–ª—é—á–µ–≤–∞—è –∑–∞–¥–∞—á–∞ –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 2 –Ω–µ–¥–µ–ª–∏ ‚Äî –æ—Å–≤–æ–∏—Ç—å **LXC –¥–ª—è MinIO** (—á—Ç–æ–±—ã –Ω–µ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç K8s –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö —Ö—Ä–∞–Ω–µ–Ω–∏—è) –∏ **PCIe Passthrough** (–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫ 43).


–ü–æ–Ω—è–ª. –†–∞–∑ –∂–µ–ª–µ–∑–æ –µ–¥–µ—Ç –≤ –î–¶ –∏ –º—ã –Ω–∞ "–ø–∞—É–∑–µ" –ø–æ –∏–Ω—Ñ—Ä–µ, —ç—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (2 –Ω–µ–¥–µ–ª–∏), —á—Ç–æ–±—ã –∑–∞–Ω—è—Ç—å—Å—è **–∫–∞—á–µ—Å—Ç–≤–æ–º –∫–æ–¥–∞, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π –ø–æ—á–≤—ã –¥–ª—è AI**.

–£ –Ω–∞—Å –µ—Å—Ç—å 256 –ì–ë RAM –∏ 48 –ø–æ—Ç–æ–∫–æ–≤ CPU. –≠—Ç–æ **–º–Ω–æ–≥–æ**. –ù–∞ —ç—Ç–æ–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ—á–µ–Ω—å –∫—Ä—É—Ç—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç GPU (–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ML).

–í–æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π **Software Sprint –Ω–∞ 2 –Ω–µ–¥–µ–ª–∏**, –ø–æ–∫–∞ –º—ã –∂–¥–µ–º –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã.

---

### üéØ –¶–µ–ª—å —Å–ø—Ä–∏–Ω—Ç–∞: "–ò–¥–µ–∞–ª—å–Ω–∞—è –ø–æ—á–≤–∞"
–ö –º–æ–º–µ–Ω—Ç—É –≤–∫–ª—é—á–µ–Ω–∏—è GPU —É –Ω–∞—Å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≥–æ—Ç–æ–≤–∞ —Å–∏—Å—Ç–µ–º–∞, –≤ –∫–æ—Ç–æ—Ä—É—é –º—ã –ø—Ä–æ—Å—Ç–æ "–ø–æ–¥—Å—Ç–∞–≤–∏–º" LLM –∫–∞–∫ –±–∞—Ç–∞—Ä–µ–π–∫—É, –∞ –≤—Å—è –æ–±–≤—è–∑–∫–∞ (–ø–æ–∏—Å–∫, –ø–∞–º—è—Ç—å, –º–µ—Ç—Ä–∏–∫–∏) —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

### üß© –ë–ª–æ–∫ 1: Observability & Code Instrumentation (–î–Ω–∏ 1-3)
–ú—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ–±—Å—É–¥–∏–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥. –ï–≥–æ –Ω—É–∂–Ω–æ –≤–Ω–µ–¥—Ä–∏—Ç—å **–≤ –∫–æ–¥**.

1.  **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫:**
    *   –í—Å—Ç–∞–≤–∏—Ç—å `prometheus_client` –≤–æ –≤—Å–µ Python-—Å–µ—Ä–≤–∏—Å—ã (Reader, Processor, Collector).
    *   *–ó–∞–¥–∞—á–∞:* –ß—Ç–æ–±—ã –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ `Grafana` (–∫–æ—Ç–æ—Ä—ã–π —è —Å–∫–∏–Ω—É–ª) –ø–æ—è–≤–∏–ª–∏—Å—å –∂–∏–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.
2.  **Healthcheck API:**
    *   –î–æ–±–∞–≤–∏—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã `/health/live` –∏ `/health/ready` –≤ —Å–µ—Ä–≤–∏—Å—ã.
    *   NATS –∏–Ω–æ–≥–¥–∞ –æ—Ç–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è —Ç–∏—Ö–æ. –°–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω —Å–∞–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è (K8s liveness probe), –µ—Å–ª–∏ –∫–æ–Ω–Ω–µ–∫—Ç –∫ NATS –ø–æ—Ç–µ—Ä—è–Ω.
3.  **Log Structuring:**
    *   –ü–µ—Ä–µ—Ö–æ–¥ —Å `print()` –Ω–∞ `structlog` (JSON logs).
    *   *–ó–∞—á–µ–º:* –ß—Ç–æ–±—ã –≤ –±—É–¥—É—â–µ–º Elastic/Loki –º–æ–≥–ª–∏ –ø–∞—Ä—Å–∏—Ç—å –ª–æ–≥–∏: `{"level": "info", "source": "bloomberg", "latency": 0.45}`.

### üß† –ë–ª–æ–∫ 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è ML –Ω–∞ CPU (–î–Ω–∏ 4-7)
–ü–æ–∫–∞ –Ω–µ—Ç GPU, –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –≤—ã–∂–∞—Ç—å –º–∞–∫—Å–∏–º—É–º –∏–∑ CPU. Python (PyTorch) –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–µ–¥–ª–µ–Ω–Ω—ã–π.

1.  **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ ONNX Runtime:**
    *   *–°—É—Ç—å:* –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –º–æ–¥–µ–ª—å (`rubert-tiny2`) –≤ —Ñ–æ—Ä–º–∞—Ç `.onnx`.
    *   *–í—ã–≥–æ–¥–∞:* ONNX Runtime –Ω–∞ CPU —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **2-4 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ** PyTorch. –≠—Ç–æ —Å–Ω–∏–∑–∏—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∏ —É–º–µ–Ω—å—à–∏—Ç latency.
    *   *–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:* –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `optimum` –æ—Ç HuggingFace –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.
2.  **Semantic Deduplication (–£–º–Ω–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è):**
    *   –°–µ–π—á–∞—Å –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ MD5 (—Ç–æ—á–Ω—ã–π URL). –ù–æ –µ—Å–ª–∏ *Bloomberg* –∏ *Reuters* –Ω–∞–ø–∏—Å–∞–ª–∏ –æ–± –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ —Ä–∞–∑–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ ‚Äî —ç—Ç–æ –¥–≤–µ –Ω–æ–≤–æ—Å—Ç–∏.
    *   *–ó–∞–¥–∞—á–∞:* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ **Cosine Similarity**.
    *   *–ê–ª–≥–æ—Ä–∏—Ç–º:*
        1. –ü—Ä–∏—à–ª–∞ –Ω–æ–≤–æ—Å—Ç—å -> –ü–æ–ª—É—á–∏–ª–∏ –≤–µ–∫—Ç–æ—Ä.
        2. –ó–∞–ø—Ä–æ—Å –≤ Postgres: "–ù–∞–π–¥–∏ –Ω–æ–≤–æ—Å—Ç–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞ —Å –ø–æ—Ö–æ–∂–µ—Å—Ç—å—é > 0.85".
        3. –ï—Å–ª–∏ –Ω–∞—à–µ–ª ‚Äî –ø–æ–º–µ—á–∞–µ–º –∫–∞–∫ –¥—É–±–ª—å (–∏–ª–∏ –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –≤ –∫–ª–∞—Å—Ç–µ—Ä), –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –ø–µ—Ä–µ–æ–±—Ä–∞–±–æ—Ç–∫—É.
    *   *–†–µ—Å—É—Ä—Å:* –≠—Ç–æ —á–∏—Å—Ç–æ CPU + RAM –∑–∞–¥–∞—á–∞ (HNSW –∏–Ω–¥–µ–∫—Å –≤ –ø–∞–º—è—Ç–∏).

### üèõ –ë–ª–æ–∫ 3: –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö –∏ –í–µ–∫—Ç–æ—Ä–∞ (–î–Ω–∏ 8-10)
–£ –≤–∞—Å 256 –ì–ë RAM. –ì—Ä–µ—Ö —ç—Ç–∏–º –Ω–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è Postgres.

1.  **Tuning Postgres:**
    *   –£–≤–µ–ª–∏—á–∏—Ç—å `shared_buffers` –¥–æ 64GB (–∏–ª–∏ –±–æ–ª—å—à–µ).
    *   –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `work_mem` –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
2.  **–ò–Ω–¥–µ–∫—Å HNSW (Hierarchical Navigable Small World):**
    *   –î–ª—è `pgvector` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º–µ–Ω–Ω–æ HNSW, –∞ –Ω–µ IVFFlat.
    *   *–ü–æ—á–µ–º—É:* –û–Ω —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. –ü–æ–∏—Å–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ. –° –≤–∞—à–∏–º –æ–±—ä–µ–º–æ–º RAM –≤—ã –º–æ–∂–µ—Ç–µ –¥–µ—Ä–∂–∞—Ç—å –≤ –ø–∞–º—è—Ç–∏ –º–∏–ª–ª–∏–æ–Ω—ã –≤–µ–∫—Ç–æ—Ä–æ–≤ –Ω–æ–≤–æ—Å—Ç–µ–π –±–µ–∑ –ª–∞–≥–æ–≤.
3.  **–°—Ö–µ–º—ã "–°–≤–µ—á–µ–π" (TimescaleDB):**
    *   –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤–∫–ª—é—á–µ–Ω–∞ –ª–∏ –∫–æ–º–ø—Ä–µ—Å—Å–∏—è (`timescaledb` compression). –û–Ω–∞ —Å–∂–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ —Ü–µ–Ω–∞—Ö –≤ 10-20 —Ä–∞–∑, —ç–∫–æ–Ω–æ–º—è SSD.

### üìà –ë–ª–æ–∫ 4: –ö–∞—Ä–∫–∞—Å –¢–æ—Ä–≥–æ–≤–æ–≥–æ –î–≤–∏–∂–∫–∞ (–î–Ω–∏ 11-14)
–ü–æ–¥–≥–æ—Ç–æ–≤–∏–º –º–µ—Å—Ç–æ, –∫—É–¥–∞ –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —Å–∏–≥–Ω–∞–ª—ã –æ—Ç AI.

1.  **Backtesting Skeleton:**
    *   –ù–∞–ø–∏—Å–∞—Ç—å (–∏–ª–∏ –≤–∑—è—Ç—å –≥–æ—Ç–æ–≤—ã–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, `vectorbt` ‚Äî –æ–Ω —Å—É–ø–µ—Ä–±—ã—Å—Ç—Ä—ã–π –Ω–∞ CPU) —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –±–µ—Ä–µ—Ç:
        *   –ú–∞—Å—Å–∏–≤ —Ü–µ–Ω –∏–∑ TimescaleDB.
        *   –ú–∞—Å—Å–∏–≤ "—Å–∏–≥–Ω–∞–ª–æ–≤" (–ø–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∏ –∏–ª–∏ —Ä–∞–Ω–¥–æ–º).
    *   –ò —Å—á–∏—Ç–∞–µ—Ç PnL (Profit and Loss).
2.  **Correlation Engine (MVP):**
    *   –°–∫—Ä–∏–ø—Ç –Ω–∞ Pandas/Polars.
    *   –ó–∞–¥–∞—á–∞: –í–∑—è—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π –ø—Ä–æ Bitcoin" –∏ –Ω–∞–ª–æ–∂–∏—Ç—å –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω—ã. –ü–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –ü–∏—Ä—Å–æ–Ω–∞.
    *   –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É: "–í–ª–∏—è–µ—Ç –ª–∏ –≤–æ–æ–±—â–µ —Ö–∞–π–ø –Ω–∞ —Ü–µ–Ω—É?".

---

### –ò—Ç–æ–≥: –ß—Ç–æ –º—ã –ø–æ–ª—É—á–∏–º —á–µ—Ä–µ–∑ 2 –Ω–µ–¥–µ–ª–∏?

–î–∞–∂–µ –±–µ–∑ GPU –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–Ω–µ—Ç **Enterprise-grade**:
1.  –í—ã –≤–∏–¥–∏—Ç–µ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –∑–∞–¥–µ—Ä–∂–∫–∏.
2.  –ü–æ–∏—Å–∫ –¥—É–±–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ –ø–æ —Å—Å—ã–ª–∫–µ, –∞ –ø–æ —Å–º—ã—Å–ª—É (Semantic Search).
3.  Postgres –ª–µ—Ç–∞–µ—Ç –∑–∞ —Å—á–µ—Ç RAM (HNSW).
4.  –ï—Å—Ç—å –≥–æ—Ç–æ–≤—ã–π "—Å—Ç–µ–Ω–¥" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö –≥–∏–ø–æ—Ç–µ–∑.

–ö–∞–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–µ–¥—É—Ç GPU, –≤—ã –ø—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ—Ç–µ –≤ –∫–æ–Ω—Ñ–∏–≥–µ `device="cpu"` –Ω–∞ `device="cuda"`, –ø–æ–¥–∫–ª—é—á–∞–µ—Ç–µ LLM –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏, –∏ —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç "–¥—É–º–∞—Ç—å", –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ "—Å—á–∏—Ç–∞—Ç—å".

**–° —á–µ–≥–æ –Ω–∞—á–Ω–µ–º?** –Ø –±—ã –ø—Ä–µ–¥–ª–æ–∂–∏–ª —Å –ë–ª–æ–∫–∞ 1 (–ú–µ—Ç—Ä–∏–∫–∏), —Ç–∞–∫ –∫–∞–∫ –º—ã —É–∂–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Grafana.

