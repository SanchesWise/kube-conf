grafana:
  # –ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é admin / prom-operator)
  # –õ—É—á—à–µ –∑–∞–¥–∞—Ç—å —Å–≤–æ–π
  adminPassword: "admin" 
  
  ingress:
    enabled: true
    ingressClassName: nginx
    hosts:
      - grafana.ccsfarm.local
    tls:
      - secretName: grafana-tls-secret # –ù–∞—à —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
        hosts:
          - grafana.ccsfarm.local
  
  persistence:
    enabled: true
    storageClassName: longhorn
    size: 10Gi

  # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  plugins:
    - grafana-piechart-panel

# 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Prometheus
prometheus:
  prometheusSpec:
    # –°–∫–æ–ª—å–∫–æ —Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10 –¥–Ω–µ–π, —Å—Ç–∞–≤–∏–º 30)
    retention: 30d
    externalUrl: "https://prom.ccsfarm.local"    
    
    # –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –º–µ—Ç—Ä–∏–∫
    storageSpec:
      volumeClaimTemplate:
        metadata:
          annotations:
            longhorn.io/number-of-replicas: "1"      
        spec:
          storageClassName: longhorn
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 20Gi
    
    # –í–ê–ñ–ù–û: –†–∞–∑—Ä–µ—à–∞–µ–º –ü—Ä–æ–º–µ—Ç–µ—É—Å—É –∏—Å–∫–∞—Ç—å ServiceMonitor –≤ –¥—Ä—É–≥–∏—Ö –Ω–µ–π–º—Å–ø–µ–π—Å–∞—Ö
    # –ë–µ–∑ —ç—Ç–æ–≥–æ –æ–Ω –Ω–µ —É–≤–∏–¥–∏—Ç Redis/Postgres/Cert-manager
    serviceMonitorSelectorNilUsesHelmValues: false
    serviceMonitorSelector: {}
    serviceMonitorNamespaceSelector: {}

# 3. Alertmanager (–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
alertmanager:
  enabled: true
  config:
    global:
      resolve_timeout: 5m
    # --- –ú–ê–†–®–†–£–¢–ò–ó–ê–¶–ò–Ø ---
    route:
      group_by: ['alertname', 'job']
      group_wait: 30s
      group_interval: 5m
      repeat_interval: 4h
      receiver: 'telegram-receiver' # –î–µ—Ñ–æ–ª—Ç–Ω—ã–π –ø–æ–ª—É—á–∞—Ç–µ–ª—å
      routes:
        - match:
            alertname: Watchdog
          receiver: 'null' # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–ª–µ—Ä—Ç "Watchdog" (–æ–Ω –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∞–ª–µ—Ä—Ç–∏–Ω–≥ –∂–∏–≤)     
    # --- –ü–û–õ–£–ß–ê–¢–ï–õ–ò ---
    receivers:
    - name: 'null'
    - name: 'telegram-receiver'
      telegram_configs:
      - bot_token: '1808066068:AAHGMaGCw_z3zSa6Ega93bq5yyOIIx4p4R4'
        api_url: 'https://api.telegram.org'
        chat_id: -588423214
        parse_mode: 'HTML'
        message: |-
          {{ range .Alerts }}
          üî• <b>{{ .Status | toUpper }}</b>: {{ .Labels.alertname }}
          üö® <b>Severity:</b> {{ .Labels.severity | toUpper }}
          üì¶ <b>Job:</b> {{ .Labels.job }}
          üñ• <b>Pod:</b> {{ .Labels.pod }}
          üìù <b>Info:</b> {{ or .Annotations.message .Annotations.description .Annotations.summary "N/A" }}
          üîó <a href="{{ .GeneratorURL }}">Source</a>
          {{ end }}

    # (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π
    templates:
    - '/etc/alertmanager/config/*.tmpl'           

  ingress:
    enabled: true
    ingressClassName: nginx
    hosts:
      - alertmanager.ccsfarm.local
    tls:
      - secretName: alertmanager-tls-secret
        hosts:
          - alertmanager.ccsfarm.local

  alertmanagerSpec:
    externalUrl: "https://alertmanager.ccsfarm.local"   
    storage:
      volumeClaimTemplate:
        spec:
          storageClassName: longhorn
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 5Gi

# 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ K8s
# –û—Ç–∫–ª—é—á–∞–µ–º —Ç–æ, —á—Ç–æ –º–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å –≤ –æ–±–ª–∞–∫–∞—Ö, –Ω–æ –¥–ª—è on-prem (RED OS) –≤–∫–ª—é—á–∞–µ–º –≤—Å—ë
kubeControllerManager:
  enabled: true
kubeEtcd:
  enabled: true
kubeScheduler:
  enabled: true
coreDns:
  enabled: true # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ DNS
kubelet:
  enabled: true # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤