–≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å. –£—á–∏—Ç—ã–≤–∞—è –≤–∞—à–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å MinIO (–∑–∞–≤–∏—Å–∞–Ω–∏—è —Å–µ—Ç–∏, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ MTU/IPv6 –∏ —Ç—è–∂–µ–ª–æ–≤–µ—Å–Ω–æ—Å—Ç—å Java-–∫–ª–∏–µ–Ω—Ç–æ–≤), –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã, –∫–æ—Ç–æ—Ä—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç MinIO.

MinIO ‚Äî —ç—Ç–æ **Strong Consistency** (—Å—Ç—Ä–æ–≥–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å) –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ Enterprise-–∂–µ–ª–µ–∑–æ. –ï—Å–ª–∏ —Å–µ—Ç—å —Å–±–æ–∏—Ç, MinIO —Ç–æ–∂–µ —Å–±–æ–∏—Ç.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –≤–∞–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã.

---

### 1. SeaweedFS (https://github.com/seaweedfs/seaweedfs)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready (–û—á–µ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω–∞)
**–Ø–∑—ã–∫:** Go
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** Based on Facebook's Haystack paper.

–≠—Ç–æ —Å–∞–º—ã–π –º–æ—â–Ω—ã–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç MinIO.

*   **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
    *   –†–∞–∑–¥–µ–ª—è–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (Filer) –∏ —Å–∞–º–∏—Ö –¥–∞–Ω–Ω—ã—Ö (Volume Servers).
    *   **–ö–∏–ª–ª–µ—Ä-—Ñ–∏—á–∞:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è **–º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–æ–≤** (Small File Problem). MinIO —Ö—Ä–∞–Ω–∏—Ç –∫–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –∫–∞–∫ —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫–µ (—á—Ç–æ —É–±–∏–≤–∞–µ—Ç inode –∏ IOPS –Ω–∞ –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–∞—Ö). SeaweedFS —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –≤ –±–æ–ª—å—à–∏–µ "—Ç–æ–º–∞" (Needles in Haystack).
*   **–ü–ª—é—Å—ã –¥–ª—è Nexus:**
    *   Docker-–æ–±—Ä–∞–∑—ã —Å–æ—Å—Ç–æ—è—Ç –∏–∑ —Å–ª–æ–µ–≤ (–±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã) –∏ –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤ (–º–µ–ª–∫–∏–µ JSON). SeaweedFS –∏–¥–µ–∞–ª—å–Ω–æ –ø–µ—Ä–µ–≤–∞—Ä–∏–≤–∞–µ—Ç –∏ —Ç–æ, –∏ –¥—Ä—É–≥–æ–µ.
    *   –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è.
    *   –ï—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∞ S3 API (–≤–∫–ª—é—á–∞—è multipart upload).
    *   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç POSIX (FUSE mount), –º–æ–∂–Ω–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ –¥–∏—Å–∫ –≤ –ø–æ–¥, –µ—Å–ª–∏ S3 –Ω–∞–¥–æ–µ—Å—Ç.
*   **–ú–∏–Ω—É—Å—ã:**
    *   –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ª–æ–∂–Ω–µ–µ, —á–µ–º —É MinIO (–Ω—É–∂–Ω–æ –¥–µ–ø–ª–æ–∏—Ç—å Master, Filer –∏ Volume —Å–µ—Ä–≤–µ—Ä—ã).
    *   S3 API –Ω–µ –Ω–∞ 100% –ø–æ–ª–Ω—ã–π (–Ω–æ –¥–ª—è Registry —Ö–≤–∞—Ç–∞–µ—Ç).

**–í–µ—Ä–¥–∏–∫—Ç:** –õ—É—á—à–∞—è –∑–∞–º–µ–Ω–∞, –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ **–≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏ –µ—Å—Ç—å –º–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–æ–≤.

---

### 2. RustFS (https://github.com/rustfs/rustfs)
**–°—Ç–∞—Ç—É—Å:** üíÄ Dead / Abandoned / Experimental
**–Ø–∑—ã–∫:** Rust

*   **–ê–Ω–∞–ª–∏–∑:** –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤—ã–≥–ª—è–¥–∏—Ç –∑–∞–±—Ä–æ—à–µ–Ω–Ω—ã–º –∏–ª–∏ —Å—É–≥—É–±–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º. –≠—Ç–æ –ø–æ–ø—ã—Ç–∫–∞ –Ω–∞–ø–∏—Å–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –§–° –Ω–∞ Rust, –Ω–æ —ç—Ç–æ **–Ω–µ** –ø—Ä–æ–¥—É–∫—Ç —É—Ä–æ–≤–Ω—è Production.
*   **–†–∏—Å–∫–∏:**
    *   –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ S3 API (–∏–ª–∏ –æ–Ω–∞ —Ä—É–¥–∏–º–µ–Ω—Ç–∞—Ä–Ω–∞).
    *   –ù–µ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ Helm-—á–∞—Ä—Ç–æ–≤.
    *   –í—ã –ø–æ—Ç—Ä–∞—Ç–∏—Ç–µ –Ω–µ–¥–µ–ª–∏ –Ω–∞ —Ç–æ, —á—Ç–æ–±—ã –ø—Ä–æ—Å—Ç–æ –∑–∞—Å—Ç–∞–≤–∏—Ç—å —ç—Ç–æ —Ä–∞–±–æ—Ç–∞—Ç—å.

**–í–µ—Ä–¥–∏–∫—Ç:** **–ó–∞–±—É–¥—å—Ç–µ.** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –≤ –ø—Ä–æ–¥–µ (–¥–∞–∂–µ –¥–æ–º–∞—à–Ω–µ–º) –Ω–µ–ª—å–∑—è.

---

### 3. Garage (https://git.deuxfleurs.fr/Deuxfleurs/garage)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready (–¥–ª—è Self-hosting/Edge)
**–Ø–∑—ã–∫:** Rust
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** CRDT (Conflict-free Replicated Data Types) + Shared-nothing.

–≠—Ç–æ **—Å–∞–º—ã–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç** –¥–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è —Å –ø—Ä–æ–±–ª–µ–º–Ω–æ–π —Å–µ—Ç—å—é/MTU.

*   **–§–∏–ª–æ—Å–æ—Ñ–∏—è:** Garage —Å–æ–∑–¥–∞–≤–∞–ª—Å—è —Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–º–∏ —ç–Ω—Ç—É–∑–∏–∞—Å—Ç–∞–º–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è **self-hosting** –Ω–∞ —Ä–∞–∑–Ω–æ–º, —Å—Ç–∞—Ä–æ–º –∏–ª–∏ –º–µ–¥–ª–µ–Ω–Ω–æ–º –∂–µ–ª–µ–∑–µ, —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–Ω–æ–º –ø–æ —Ä–∞–∑–Ω—ã–º –ª–æ–∫–∞—Ü–∏—è–º (geo-distributed).
*   **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
    *   –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç MinIO (–∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç –∂–µ—Å—Ç–∫–æ–π –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –±—ã—Å—Ç—Ä—ã—Ö –¥–∏—Å–∫–æ–≤), Garage –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **CRDT**. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –æ–Ω —É—Å—Ç–æ–π—á–∏–≤ –∫ "–º–∏–≥–∞–Ω–∏—é" —Å–µ—Ç–∏ (Network Partitions).
    *   –ï—Å–ª–∏ –Ω–æ–¥–∞ –æ—Ç–≤–∞–ª–∏–ª–∞—Å—å –∏–ª–∏ –ø–∞–∫–µ—Ç –ø–æ—Ç–µ—Ä—è–ª—Å—è, Garage —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–∑–∂–µ.
    *   –ù–∞–ø–∏—Å–∞–Ω –Ω–∞ Rust -> —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ –ª–µ–≥–∫–∏–π –∏ –±—ã—Å—Ç—Ä—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫.
    *   –û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.
*   **–ü–ª—é—Å—ã –¥–ª—è Nexus:**
    *   **Resilience:** –ì–æ—Ä–∞–∑–¥–æ –º–µ–Ω–µ–µ –∫–∞–ø—Ä–∏–∑–µ–Ω –∫ —Å–µ—Ç–µ–≤—ã–º –ª–∞–≥–∞–º, MTU –∏ IPv6, —á–µ–º MinIO.
    *   –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π S3 API (v4 signatures —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω–æ).
    *   –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π: –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –∫–æ–ø–µ–π–∫–∏ RAM –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å MinIO.
*   **–ú–∏–Ω—É—Å—ã:**
    *   –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ *–æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö* —Å–∫–æ—Ä–æ—Å—Ç—è—Ö (10Gbps+) –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∏–∂–µ, —á–µ–º —É MinIO/SeaweedFS (–∏–∑-–∑–∞ –ª–æ–≥–∏–∫–∏ CRDT), –Ω–æ –¥–ª—è Nexus —ç—Ç–æ–≥–æ –∑–∞ –≥–ª–∞–∑–∞.
    *   –ú–µ–Ω—å—à–µ –∫–æ–º—å—é–Ω–∏—Ç–∏, —á–µ–º —É MinIO.

**–í–µ—Ä–¥–∏–∫—Ç:** **–ò–¥–µ–∞–ª—å–Ω—ã–π –∫–∞–Ω–¥–∏–¥–∞—Ç**, —á—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å –≤–∞—à–∏ "–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ" —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã. –û–Ω –ø—Ä–æ—Å—Ç, –Ω–∞–¥–µ–∂–µ–Ω –∏ –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Rust.

---

### –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | MinIO | SeaweedFS | Garage |
| :--- | :--- | :--- | :--- |
| **–Ø–∑—ã–∫** | Go | Go | Rust |
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | Monolithic / Erasure Coding | Haystack (Filer + Volume) | CRDT / Mesh |
| **–°–µ—Ç—å** | –¢—Ä–µ–±—É–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ | –¢—Ä–µ–±—É–µ—Ç —Ö–æ—Ä–æ—à–µ–π —Å–µ—Ç–∏ | **–£—Å—Ç–æ–π—á–∏–≤ –∫ –ø–ª–æ—Ö–æ–π —Å–µ—Ç–∏** |
| **–ú–µ–ª–∫–∏–µ —Ñ–∞–π–ª—ã** | –ü–ª–æ—Ö–æ (—Ç—Ä–∞—Ç–∏—Ç inodes) | **–ò–¥–µ–∞–ª—å–Ω–æ** | –•–æ—Ä–æ—à–æ |
| **S3 API** | –≠—Ç–∞–ª–æ–Ω (100%) | –•–æ—Ä–æ—à–æ (90%) | –•–æ—Ä–æ—à–æ (90%) |
| **–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ RAM** | –í—ã—Å–æ–∫–æ–µ | –°—Ä–µ–¥–Ω–µ–µ | **–ù–∏–∑–∫–æ–µ** |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å** | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è | –ù–∏–∑–∫–∞—è |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è CCSFARM

–£—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –≤—ã –±–æ—Ä–µ—Ç–µ—Å—å —Å –∑–∞–≤–∏—Å–∞–Ω–∏–µ–º –ø—É—à–∞ (—Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫, MTU, –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è) –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ S3 —Ç–æ–ª—å–∫–æ –∫–∞–∫ –±—ç–∫–µ–Ω–¥ –¥–ª—è Nexus:

1.  **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ Garage.**
    –≠—Ç–æ —Å–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ –∏ "–ª–µ—á–µ–±–Ω–æ–µ" —Ä–µ—à–µ–Ω–∏–µ. –û–Ω –Ω–µ –±—É–¥–µ—Ç –≤–∏—Å–Ω—É—Ç—å —Ç–∞–º, –≥–¥–µ –≤–∏—Å–Ω–µ—Ç MinIO, —Ç–∞–∫ –∫–∞–∫ –µ–≥–æ —Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫ –Ω–∞ Rust (Tokio) –∏ –ª–æ–≥–∏–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ—â–∞—é—Ç –æ—à–∏–±–∫–∏.
    –£ –Ω–µ–≥–æ –µ—Å—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Helm chart –∏–ª–∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Å—Ç–æ –≤ Docker/Podman.

2.  **–ï—Å–ª–∏ Garage –Ω–µ –ø–æ–¥–æ–π–¥–µ—Ç ‚Äî SeaweedFS.**
    –≠—Ç–æ –µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–∞ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ —Ö—Ä–∞–Ω–∏—Ç—å —Ç–∞–º –º–∏–ª–ª–∏–æ–Ω—ã —Ñ–∞–π–ª–æ–≤ –ø–æ–º–∏–º–æ –¥–æ–∫–µ—Ä-–æ–±—Ä–∞–∑–æ–≤.

**RustFS** –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—á–µ—Ä–∫–∏–≤–∞–µ–º.

**–ö–∞–∫ –±—ã—Å—Ç—Ä–æ –ø–æ–¥–Ω—è—Ç—å Garage –≤ K8s –¥–ª—è —Ç–µ—Å—Ç–∞ Nexus:**

```yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: garage
spec:
  serviceName: garage
  replicas: 1 # –î–ª—è —Ç–µ—Å—Ç–∞ —Ö–≤–∞—Ç–∏—Ç –æ–¥–Ω–æ–π
  selector:
    matchLabels:
      app: garage
  template:
    metadata:
      labels:
        app: garage
    spec:
      containers:
      - name: garage
        image: dxflrs/garage:v0.9
        args: ["server"]
        ports:
        - containerPort: 3900 # S3 API
        - containerPort: 3901 # RPC
        - containerPort: 3902 # Admin API
        volumeMounts:
        - name: config
          mountPath: /etc/garage.toml
          subPath: garage.toml
        - name: data
          mountPath: /var/lib/garage
      volumes:
      - name: config
        configMap:
          name: garage-config
  volumeClaimTemplates:
  - metadata:
      name: data
    spec:
      accessModes: [ "ReadWriteOnce" ]
      resources:
        requests:
          storage: 50Gi
```

–í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ `garage.toml` (–≥–¥–µ –≤–∫–ª—é—á–∏—Ç—å S3 api) –∏ —Å–æ–∑–¥–∞—Ç—å –∫–ª—é—á–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–µ–º —Å–∞–º—ã–º —Ä–µ—à–µ–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä–æ–µ "–ø—Ä–æ–±—å–µ—Ç" —Å–µ—Ç–µ–≤–æ–π –∑–∞—Ç–æ—Ä.


**Garage (GarageHQ)** ‚Äî —ç—Ç–æ "—à–≤–µ–π—Ü–∞—Ä—Å–∫–∏–π –Ω–æ–∂" —Å—Ä–µ–¥–∏ S3-—Ö—Ä–∞–Ω–∏–ª–∏—â. –ï—Å–ª–∏ MinIO ‚Äî —ç—Ç–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç–∞–Ω–∫ (–º–æ—â–Ω—ã–π, –∂–µ—Å—Ç–∫–∏–π, —Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ), —Ç–æ Garage ‚Äî —ç—Ç–æ –±–∞–≥–≥–∏ –¥–ª—è —Ä–∞–ª–ª–∏ (–ª–µ–≥–∫–∏–π, –º–∞–Ω–µ–≤—Ä–µ–Ω–Ω—ã–π, –ø—Ä–æ—â–∞–µ—Ç –æ—à–∏–±–∫–∏ –ª–∞–Ω–¥—à–∞—Ñ—Ç–∞/—Å–µ—Ç–∏).

–û–Ω –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ **Rust**, —á—Ç–æ –¥–∞–µ—Ç –µ–º—É —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –º–∏–∑–µ—Ä–Ω–æ–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏ (–¥–µ—Å—è—Ç–∫–∏ –º–µ–≥–∞–±–∞–π—Ç, –∞ –Ω–µ –≥–∏–≥–∞–±–∞–π—Ç—ã, –∫–∞–∫ —É Java/MinIO).

–í–æ—Ç –ø–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

---

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –§–∏–ª–æ—Å–æ—Ñ–∏—è

Garage –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö **CRDT** (Conflict-free Replicated Data Types) –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ **DynamoDB**.

*   **Shared-Nothing:** –ù–µ—Ç "–º–∞—Å—Ç–µ—Ä-–Ω–æ–¥—ã". –í—Å–µ –Ω–æ–¥—ã —Ä–∞–≤–Ω—ã. –õ—é–±–∞—è –Ω–æ–¥–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å.
*   **Mesh-—Å–µ—Ç—å:** –ù–æ–¥—ã –æ–±—â–∞—é—Ç—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É —Å–ø–ª–µ—Ç–µ–Ω (Gossip).
*   **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–±–æ—è–º (Partition Tolerance):** –≠—Ç–æ –µ–≥–æ –≥–ª–∞–≤–Ω–∞—è —Ñ–∏—à–∫–∞.
    *   MinIO —Ç—Ä–µ–±—É–µ—Ç **—Å—Ç—Ä–æ–≥–æ–≥–æ –∫–≤–æ—Ä—É–º–∞** (–µ—Å–ª–∏ –ø–æ–ª–æ–≤–∏–Ω–∞ –¥–∏—Å–∫–æ–≤/—Å–µ—Ç–∏ –æ—Ç–≤–∞–ª–∏–ª–∞—Å—å –∏–ª–∏ —Ç–æ—Ä–º–æ–∑–∏—Ç ‚Äî –∑–∞–ø–∏—Å—å –≤—Å—Ç–∞–Ω–µ—Ç –∫–æ–ª–æ–º).
    *   Garage —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É **Eventual Consistency** (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å—á–µ—Ç–µ). –ï—Å–ª–∏ —Å–µ—Ç—å "–º–∏–≥–Ω—É–ª–∞", Garage –ø—Ä–∏–º–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–¥—ã, –∞ –∫–æ–≥–¥–∞ —Å–µ—Ç—å –≤–µ—Ä–Ω–µ—Ç—Å—è ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–µ. **–≠—Ç–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É "–∑–∞–≤–∏—Å–∞–Ω–∏—è –ø—É—à–∞" –ø—Ä–∏ –ø–ª–æ—Ö–æ–º MTU/IPv6.**

---

### 2. –ì–¥–µ –∏ –∫–∞–∫ –æ–Ω —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ?

Garage **–Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Ñ–∞–π–ª—ã –∫–∞–∫ —Ñ–∞–π–ª—ã** (1-–≤-1). –û–Ω —Ä–∞–∑–±–∏–≤–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã –Ω–∞ —á–∞–Ω–∫–∏ (–±–ª–æ–∫–∏).

–í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`garage.toml`) –≤—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ –¥–≤–µ –∫–ª—é—á–µ–≤—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:

#### –ê. Metadata Directory (`metadata_dir`)
*   **–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç:** –°–ø–∏—Å–æ–∫ –±–∞–∫–µ—Ç–æ–≤, –∫–ª—é—á–µ–π, –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞, —Å–ø–∏—Å–æ–∫ —á–∞–Ω–∫–æ–≤, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ—Å—Ç–æ—è—Ç —Ñ–∞–π–ª—ã.
*   **–î–≤–∏–∂–æ–∫:** –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è KV-–±–∞–∑–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç `sled` –∏–ª–∏ `lmdb` –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º).
*   **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** –û—á–µ–Ω—å –ª—é–±–∏—Ç **IOPS**.
*   **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫–ª–∞—Å—Ç—å –Ω–∞ **SSD (Longhorn/LocalPV)**.

#### –ë. Data Directory (`data_dir`)
*   **–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç:** "–°—ã—Ä—ã–µ" –∫—É—Å–∫–∏ –¥–∞–Ω–Ω—ã—Ö (—á–∞–Ω–∫–∏), —Å–∂–∞—Ç—ã–µ (Zstd –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏ –¥–µ–¥—É–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ.
*   **–ö–∞–∫ —Ö—Ä–∞–Ω–∏—Ç:** –ö—Ä—É–ø–Ω—ã–º–∏ –±–ª–æ–∫–∞–º–∏. –≠—Ç–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É "–º–∏–ª–ª–∏–æ–Ω–∞ –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–æ–≤", –∫–æ—Ç–æ—Ä–∞—è —É–±–∏–≤–∞–µ—Ç –æ–±—ã—á–Ω—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã.
*   **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** –õ—é–±–∏—Ç –æ–±—ä–µ–º, IOPS –Ω–µ –≤–∞–∂–Ω—ã.
*   **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ú–æ–∂–Ω–æ –∫–ª–∞—Å—Ç—å –Ω–∞ **HDD (NFS, –º–µ–¥–ª–µ–Ω–Ω—ã–π Longhorn)**.

**–í–∞–∂–Ω–∞—è —Ñ–∏—á–∞ –¥–ª—è –≤–∞—Å:** –í—ã –º–æ–∂–µ—Ç–µ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –±—ã—Å—Ç—Ä—ã–π –¥–∏—Å–∫ –¥–ª—è –±–∞–∑—ã –∏ –º–µ–¥–ª–µ–Ω–Ω—ã–π (NFS) –¥–ª—è —Å–∞–º–∏—Ö –±–ª–æ–±–æ–≤. Garage —Å–∞–º —Ä–∞–∑–±–µ—Ä–µ—Ç—Å—è.

---

### 3. –ö–∞–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è?

–£ Garage –Ω–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ Web-UI (–∫–∞–∫ —É MinIO Console). –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–≥–æ —á–µ—Ä–µ–∑ **CLI** –∏–ª–∏ **S3 API**.

#### –ê. CLI —É—Ç–∏–ª–∏—Ç–∞ (`garage`)
–≠—Ç–æ –±–∏–Ω–∞—Ä–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∏—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –í—ã —É–ø—Ä–∞–≤–ª—è–µ—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–º, –∑–∞–ø—É—Å–∫–∞—è –∫–æ–º–∞–Ω–¥—ã –≤–Ω—É—Ç—Ä–∏ –ø–æ–¥–∞ (–∏–ª–∏ —Å –∞–¥–º–∏–Ω—Å–∫–æ–π –º–∞—à–∏–Ω—ã, –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–π –∫ RPC –ø–æ—Ä—Ç—É).

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
*   `garage status` ‚Äî –∑–¥–æ—Ä–æ–≤—å–µ –∫–ª–∞—Å—Ç–µ—Ä–∞.
*   `garage layout` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ø–æ–ª–æ–≥–∏–µ–π (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Å–∫–æ–≤, –Ω–æ–¥).
*   `garage bucket` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –±–∞–∫–µ—Ç–æ–≤.
*   `garage key` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ Access/Secret –∫–ª—é—á–µ–π.

#### –ë. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è "Layout" (–†–∞—Å–∫–ª–∞–¥–∫–∞)
–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç MinIO, –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –¥–∏—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ, –≤ Garage –≤—ã –¥–æ–ª–∂–Ω—ã **—è–≤–Ω–æ** —Å–∫–∞–∑–∞—Ç—å: "–≠—Ç–∞ –Ω–æ–¥–∞ –≤—Å—Ç—É–ø–∞–µ—Ç –≤ –∏–≥—Ä—É —Å —Ç–∞–∫–æ–π-—Ç–æ —Ä–æ–ª—å—é".

1.  –ó–∞–ø—É—Å–∫–∞–µ—Ç–µ –Ω–æ–≤—É—é –Ω–æ–¥—É. –û–Ω–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ `garage status` –∫–∞–∫ "–æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è".
2.  –í—ã –¥–∞–µ—Ç–µ –µ–π —Ä–æ–ª—å –∏ —Ä–∞–∑–º–µ—Ä (–≤–µ—Å):
    ```bash
    garage layout assign <NODE_ID> -z zone1 -c 1T
    ```
    *(–ó–æ–Ω–∞ 1, –µ–º–∫–æ—Å—Ç—å 1 –¢–µ—Ä–∞–±–∞–π—Ç)*.
3.  –ü—Ä–∏–º–µ–Ω—è–µ—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
    ```bash
    garage layout apply
    ```
Garage –Ω–∞—á–Ω–µ—Ç –ø–µ—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ–Ω–µ.

---

### 4. –í–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–¢–æ–ø–æ–ª–æ–≥–∏–∏)

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: –û–¥–∏–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º (Standalone)
*   1 –ü–æ–¥, 1 –î–∏—Å–∫ (PVC).
*   –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏–ª–∏ –∫–∞–∫ –∫—ç—à-–ø—Ä–æ–∫—Å–∏.
*   *–í–∞—à —Ç–µ–∫—É—â–∏–π —Å–ª—É—á–∞–π –¥–ª—è —Ç–µ—Å—Ç–∞.*

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: –õ–æ–∫–∞–ª—å–Ω—ã–π –ö–ª–∞—Å—Ç–µ—Ä (Local HA)
*   3+ –ü–æ–¥–∞ (StatefulSet).
*   –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3 –∫–æ–ø–∏–∏).
*   –ï—Å–ª–∏ –æ–¥–Ω–∞ –Ω–æ–¥–∞/–¥–∏—Å–∫ —É–º–∏—Ä–∞–µ—Ç, –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã.

#### –í–∞—Ä–∏–∞–Ω—Ç –í: –ì–µ–æ-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π (Multi-DC)
*   –ù–æ–¥—ã –≤ —Ä–∞–∑–Ω—ã—Ö –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞—Ö (—Ä–∞–∑–Ω—ã–µ `zone` –≤ –∫–æ–Ω—Ñ–∏–≥–µ).
*   Garage —É–º–µ–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å 2 –∫–æ–ø–∏–∏ –≤ –æ–¥–Ω–æ–π –∑–æ–Ω–µ –∏ 1 –∫–æ–ø–∏—é –≤ –¥—Ä—É–≥–æ–π.
*   –£—Å—Ç–æ–π—á–∏–≤ –∫ –ø–∞–¥–µ–Ω–∏—é —Ü–µ–ª–æ–≥–æ –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞.

---

### 5. –ü—Ä–∏–º–µ—Ä –¥–ª—è Kubernetes (–í–∞—à —Å–ª—É—á–∞–π)

–í–∞–º –Ω—É–∂–µ–Ω –∫–æ–Ω—Ñ–∏–≥ `garage.toml`, –∫–æ—Ç–æ—Ä—ã–π –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ ConfigMap.

**ConfigMap:**
```toml
[replication_mode]
# –î–ª—è 1 –Ω–æ–¥—ã —Å—Ç–∞–≤–∏–º "none". –î–ª—è 3 –Ω–æ–¥ —Å—Ç–∞–≤–∏–º "3-copy".
replication_mode = "none"

[db]
engine = "lmdb"

[rpc]
# –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç –¥–ª—è –æ–±—â–µ–Ω–∏—è –Ω–æ–¥ (gossip)
bind_addr = "[::]:3901"
# –°–µ–∫—Ä–µ—Ç –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏ (—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ openssl rand -hex 32)
secret = "a1b2c3d4..." 

[s3_api]
# –ü–æ—Ä—Ç –¥–ª—è Nexus –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
s3_region = "us-east-1"
api_bind_addr = "[::]:3900"
root_domain = ".s3.ccsfarm.local" # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è virtual-host style

[s3_web]
bind_addr = "[::]:3902" # –î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤ (–≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ)
```

**–ó–∞–ø—É—Å–∫ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–æ–¥–∏–Ω —Ä–∞–∑):**

1.  –î–µ–ø–ª–æ–∏—Ç–µ StatefulSet.
2.  –ó–∞—Ö–æ–¥–∏—Ç–µ –≤ –ø–æ–¥: `kubectl exec -it garage-0 -- sh`.
3.  –°–º–æ—Ç—Ä–∏—Ç–µ —Å—Ç–∞—Ç—É—Å: `garage status`.
4.  –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ –ª—ç–π–∞—É—Ç (–≥–æ–≤–æ—Ä–∏–º, —á—Ç–æ —É –Ω–∞—Å 1 –Ω–æ–¥–∞ —Å –±–µ–∑–ª–∏–º–∏—Ç–Ω—ã–º –º–µ—Å—Ç–æ–º):
    ```bash
    garage layout assign -z dc1 -c 100G $(garage status | grep "ID" | awk '{print $2}')
    garage layout apply --version 1
    ```
5.  –°–æ–∑–¥–∞–µ—Ç–µ –∫–ª—é—á–∏:
    ```bash
    garage key create nexus-key
    # –í—ã–¥–∞—Å—Ç Access Key / Secret Key
    ```
6.  –°–æ–∑–¥–∞–µ—Ç–µ –±–∞–∫–µ—Ç:
    ```bash
    garage bucket create nexus-data
    ```

–í—Å–µ. –£ –≤–∞—Å –µ—Å—Ç—å S3 endpoint –Ω–∞ –ø–æ—Ä—Ç—É 3900.

### –ü–æ—á–µ–º—É —ç—Ç–æ —Å–ø–∞—Å–µ—Ç –≤–∞—à Nexus?

1.  **–¢–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫ —Å–µ—Ç–∏:** Garage –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Rust (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Tokio). –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π I/O –∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫–∏ –ø—Ä–∏ –º–µ–¥–ª–µ–Ω–Ω–æ–π —Å–µ—Ç–∏ —Ç–∞–∫, –∫–∞–∫ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç Java (Nexus) –∏–ª–∏ Go (MinIO) –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö.
2.  **–°–∂–∞—Ç–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞:** Garage —Å–∂–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ Zstd –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é.
3.  **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä–æ–≥–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫:** –ï—Å–ª–∏ –ø–∞–∫–µ—Ç –ø–æ—Ç–µ—Ä—è–ª—Å—è, Garage –ø–æ–≤—Ç–æ—Ä–∏—Ç –ø–æ–ø—ã—Ç–∫—É –º—è–≥—á–µ, –±–µ–∑ —Ä–∞–∑—Ä—ã–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–ü–æ–¥–Ω–∏–º–∏—Ç–µ Garage –≤ –Ω–µ–π–º—Å–ø–µ–π—Å–µ `nexus`. –î–∞–π—Ç–µ –µ–º—É PVC –Ω–∞ 50–ì–ë. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Nexus –Ω–∞ `http://garage:3900`. –≠—Ç–æ –∑–∞–π–º–µ—Ç 10 –º–∏–Ω—É—Ç –∏ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 90% —Ä–µ—à–∏—Ç –ø—Ä–æ–±–ª–µ–º—É –∑–∞–≤–∏—Å–∞–Ω–∏—è.

–í–æ—Ç –≥–æ—Ç–æ–≤—ã–π –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –º–∞–Ω–∏—Ñ–µ—Å—Ç. –û–Ω —Ä–µ–∞–ª–∏–∑—É–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—É—é —Å—Ö–µ–º—É —Ö—Ä–∞–Ω–µ–Ω–∏—è (–±—ã—Å—Ç—Ä—ã–π SSD –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö + –±–æ–ª—å—à–æ–π NFS –¥–ª—è –±–ª–æ–±–æ–≤), –∫–æ—Ç–æ—Ä–∞—è –∏–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Garage.

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
1.  **–î–≤–∞ PVC —à–∞–±–ª–æ–Ω–∞:**
    *   `meta-vol` (10Gi) -> **Longhorn** (–±—ã—Å—Ç—Ä—ã–µ –∏–Ω–¥–µ–∫—Å—ã, KV-–±–∞–∑–∞).
    *   `data-vol` (300Gi) -> **NFS** (—Å–∂–∞—Ç—ã–µ –∏ –¥–µ–¥—É–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–∞–Ω–∫–∏ –¥–∞–Ω–Ω—ã—Ö).
2.  **ConfigMap:** –ù–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Ä–∞–±–æ—Ç—É —Å –æ–¥–Ω–æ–π –Ω–æ–¥–æ–π (–¥–ª—è –Ω–∞—á–∞–ª–∞), S3 API –Ω–∞ –ø–æ—Ä—Ç—É 3900.
3.  **Init-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:** –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ NFS —Ç–æ–º–µ (—á–∞—Å—Ç–∞—è –ø—Ä–æ–±–ª–µ–º–∞).

### –§–∞–π–ª: `garage-deploy.yaml`

```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: garage

---
# 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Garage
apiVersion: v1
kind: ConfigMap
metadata:
  name: garage-config
  namespace: garage
data:
  garage.toml: |
    # –ü—É—Ç–∏ –∫ –¥–∞–Ω–Ω—ã–º (–¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å mountPath –≤ StatefulSet)
    metadata_dir = "/var/lib/garage/meta"
    data_dir = "/var/lib/garage/data"

    # –†–µ–∂–∏–º —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏. –î–ª—è –æ–¥–Ω–æ–π –Ω–æ–¥—ã "none".
    # –ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç–µ –Ω–æ–¥—ã –≤ –±—É–¥—É—â–µ–º, —Å–º–µ–Ω–∏—Ç–µ –Ω–∞ "2-copy" –∏–ª–∏ "3-copy".
    replication_mode = "none"

    [db]
    engine = "lmdb"

    [rpc]
    bind_addr = "[::]:3901"
    # –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É: openssl rand -hex 32
    # –≠—Ç–æ —Å–µ–∫—Ä–µ—Ç –¥–ª—è –æ–±—â–µ–Ω–∏—è –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏ garage
    secret = "5f6e8d9c0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d"

    [s3_api]
    s3_region = "us-east-1"
    api_bind_addr = "[::]:3900"
    root_domain = ".s3.garage.svc.cluster.local"

    [s3_web]
    bind_addr = "[::]:3902"
    root_domain = ".web.garage.svc.cluster.local"

---
# 2. –°–µ—Ä–≤–∏—Å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ (Headless –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ + ClusterIP –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤)
apiVersion: v1
kind: Service
metadata:
  name: garage
  namespace: garage
  labels:
    app: garage
spec:
  ports:
    - name: s3-api
      port: 3900
      targetPort: 3900
    - name: rpc
      port: 3901
      targetPort: 3901
    - name: web
      port: 3902
      targetPort: 3902
  selector:
    app: garage
  clusterIP: None # Headless service –≤–∞–∂–µ–Ω –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–∏—Ä–æ–≤

---
# 3. StatefulSet —Å –¥–≤—É–º—è —Ç–∏–ø–∞–º–∏ –¥–∏—Å–∫–æ–≤
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: garage
  namespace: garage
spec:
  serviceName: "garage"
  replicas: 1 # –ù–∞—á–Ω–µ–º —Å –æ–¥–Ω–æ–π –Ω–æ–¥—ã
  selector:
    matchLabels:
      app: garage
  template:
    metadata:
      labels:
        app: garage
    spec:
      securityContext:
        fsGroup: 1000
        runAsUser: 1000
        runAsGroup: 1000

      # Init-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è NFS)
      initContainers:
        - name: fix-permissions
          image: busybox:1.36
          command:
            - sh
            - -c
            - >
              mkdir -p /var/lib/garage/meta &&
              mkdir -p /var/lib/garage/data &&
              chown -R 1000:1000 /var/lib/garage &&
              chmod 700 /var/lib/garage/meta &&
              chmod 700 /var/lib/garage/data
          securityContext:
            runAsUser: 0
          volumeMounts:
            - name: meta-vol
              mountPath: /var/lib/garage/meta
            - name: data-vol
              mountPath: /var/lib/garage/data

      containers:
        - name: garage
          image: dxflrs/garage:v1.0.0
          args: ["server"]
          ports:
            - containerPort: 3900
              name: s3-api
            - containerPort: 3901
              name: rpc
          volumeMounts:
            - name: config
              mountPath: /etc/garage.toml
              subPath: garage.toml
            - name: meta-vol
              mountPath: /var/lib/garage/meta
            - name: data-vol
              mountPath: /var/lib/garage/data
          resources:
            requests:
              cpu: "100m"
              memory: "128Mi"
            limits:
              cpu: "500m"
              memory: "512Mi" # Garage –æ—á–µ–Ω—å —ç–∫–æ–Ω–æ–º–µ–Ω –∫ –ø–∞–º—è—Ç–∏

      volumes:
        - name: config
          configMap:
            name: garage-config

  # –ó–∞–ø—Ä–æ—Å –¥–∏—Å–∫–æ–≤ (–¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Å–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è)
  volumeClaimTemplates:
    # 1. –ë—ã—Å—Ç—Ä—ã–π –¥–∏—Å–∫ –¥–ª—è –ë–î (Metadata)
    - metadata:
        name: meta-vol
      spec:
        accessModes: [ "ReadWriteOnce" ]
        storageClassName: longhorn  # SSD
        resources:
          requests:
            storage: 10Gi

    # 2. –ú–µ–¥–ª–µ–Ω–Ω—ã–π/–ë–æ–ª—å—à–æ–π –¥–∏—Å–∫ –¥–ª—è –î–∞–Ω–Ω—ã—Ö (Blobs)
    - metadata:
        name: data-vol
      spec:
        accessModes: [ "ReadWriteOnce" ] # Garage —Å–∞–º –º–µ–Ω–µ–¥–∂–∏—Ç –¥–æ—Å—Ç—É–ø, RWO –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
        storageClassName: managed-nfs-storage # NFS
        resources:
          requests:
            storage: 300Gi
```

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É (Initial Setup)

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç MinIO, Garage –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è. –ï–≥–æ –Ω—É–∂–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å.

1.  **–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç:**
    ```bash
    kubectl apply -f garage-deploy.yaml
    ```

2.  **–ó–∞–π–¥–∏—Ç–µ –≤–Ω—É—Ç—Ä—å –ø–æ–¥–∞:**
    ```bash
    kubectl exec -it garage-0 -n garage -- sh
    ```

3.  **–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å—Ç–∞—Ç—É—Å:**
    ```bash
    garage status
    ```
    –í—ã —É–≤–∏–¥–∏—Ç–µ —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ `ID: <–¥–ª–∏–Ω–Ω—ã–π-—Ö—ç—à> ... UNCONFIGURED`.

4.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Layout (–†–∞—Å–∫–ª–∞–¥–∫—É):**
    –ú—ã –≥–æ–≤–æ—Ä–∏–º –ì–∞—Ä–∞–∂—É: "–ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç—É –Ω–æ–¥—É –≤ –∑–æ–Ω–µ `dc1` —Å –µ–º–∫–æ—Å—Ç—å—é 300GB".
    *(–°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –Ω–æ–¥—ã –∏–∑ –≤—ã–≤–æ–¥–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∏–∂–µ)*

    ```bash
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ID –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏
    MY_ID=$(garage status | grep "ID" | head -n1 | awk '{print $2}')
    garage layout assign -z dc1 -c 300G $MY_ID
    
    # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    garage layout apply --version 1
    ```

5.  **–°–æ–∑–¥–∞–π—Ç–µ –ö–ª—é—á–∏ (Access Key / Secret Key):**
    ```bash
    garage key create nexus-key
    ```
    *–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—ã–¥–∞–Ω–Ω—ã–µ Key ID –∏ Secret Key! –û–Ω–∏ –Ω—É–∂–Ω—ã –¥–ª—è Nexus.*

6.  **–°–æ–∑–¥–∞–π—Ç–µ –ë–∞–∫–µ—Ç:**
    ```bash
    garage bucket create nexus-docker-blob
    # –†–∞–∑—Ä–µ—à–∞–µ–º –¥–æ—Å—Ç—É–ø –∫–ª—é—á—É –∫ –±–∞–∫–µ—Ç—É
    garage bucket allow nexus-docker-blob --read --write --owner --key nexus-key
    ```

### –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –≤ Nexus

*   **Endpoint:** `http://garage.garage.svc.cluster.local:3900`
*   **Region:** `us-east-1`
*   **Access/Secret:** (—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ –≤ –ø—É–Ω–∫—Ç–µ 5)
*   **Signature:** `AWSS3V4SignerType`
*   **Path-style access:** ‚úÖ (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)


–í–æ—Ç **–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∏ –ø–æ–ª–Ω—ã–π –±–ª–æ–∫ –∫–æ–º–∞–Ω–¥** –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ —Ü–µ–ª–∏–∫–æ–º.

```bash
# 1. –ü–æ–ª—É—á–∞–µ–º ID –Ω–æ–¥—ã (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ö–û–ú–ê–ù–î–ê)
# –ú—ã –±–µ—Ä–µ–º –ü–û–°–õ–ï–î–ù–Æ–Æ —Å—Ç—Ä–æ–∫—É –≤—ã–≤–æ–¥–∞, –∞ –Ω–µ –ø–µ—Ä–≤—É—é, –∏ –∏–∑ –Ω–µ–µ –±–µ—Ä–µ–º –ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ.
NODE_ID=$(kubectl exec -n garage garage-0 -- /garage status | tail -n 1 | awk '{print $1}' | tr -d '\r')

echo "‚úÖ ID –Ω–æ–¥—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω: $NODE_ID"

# 2. –ù–∞–∑–Ω–∞—á–∞–µ–º —Ä–æ–ª—å (Zone: dc1, Capacity: 300GB)
echo "–ù–∞–∑–Ω–∞—á–∞–µ–º —Ä–æ–ª—å..."
kubectl exec -n garage garage-0 -- /garage layout assign -z dc1 -c 300G $NODE_ID

# 3. –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è (—ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç –æ—à–∏–±–∫—É "replication factor")
echo "–ü—Ä–∏–º–µ–Ω—è–µ–º layout..."
kubectl exec -n garage garage-0 -- /garage layout apply --version 1

# 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –ø—Ä–∏–º–µ–Ω–∏–ª–æ—Å—å
echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å..."
kubectl exec -n garage garage-0 -- /garage status```

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –±–ª–æ–∫–∞ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ —É –Ω–æ–¥—ã –≤ `garage status` –ø–æ—è–≤–∏–ª–∞—Å—å —Ä–æ–ª—å, –∑–æ–Ω–∞ –∏ –µ–º–∫–æ—Å—Ç—å.**

---

### –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ (–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π –∏ –±–∞–∫–µ—Ç–∞)

–ö–∞–∫ —Ç–æ–ª—å–∫–æ `garage status` –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ –Ω–æ–¥–∞ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è Nexus:

```bash
# 1. –°–æ–∑–¥–∞–µ–º –∫–ª—é—á (–°–ö–û–ü–ò–†–£–ô–¢–ï –í–´–í–û–î!)
echo "–°–æ–∑–¥–∞–µ–º –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞ (—Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ!):"
kubectl exec -n garage garage-0 -- /garage key create nexus-key

# 2. –°–æ–∑–¥–∞–µ–º –±–∞–∫–µ—Ç
echo "–°–æ–∑–¥–∞–µ–º –±–∞–∫–µ—Ç..."
kubectl exec -n garage garage-0 -- /garage bucket create nexus-docker-blob

# 3. –î–∞–µ–º –ø—Ä–∞–≤–∞
echo "–í—ã–¥–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –±–∞–∫–µ—Ç..."
kubectl exec -n garage garage-0 -- /garage bucket allow nexus-docker-blob --read --write --owner --key nexus-key
```

–¢–µ–ø–µ—Ä—å –≤–∞—à Garage –≥–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç Nexus.